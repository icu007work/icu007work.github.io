<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Github Action实现Android自动打包并发布apk | 米奇妙妙屋</title><meta name="keywords" content="二次元 码农 地中海"><meta name="author" content="Rookie_l"><meta name="copyright" content="Rookie_l"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#18171d"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Github Action实现Android自动打包并发布apk"><meta name="application-name" content="Github Action实现Android自动打包并发布apk"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#18171d"><meta property="og:type" content="article"><meta property="og:title" content="Github Action实现Android自动打包并发布apk"><meta property="og:url" content="https://icu007work.github.io/archives/40fd71e7.html"><meta property="og:site_name" content="米奇妙妙屋"><meta property="og:description" content="Github Action介绍一、Github Action 是什么？是 Github 推出的持续集成工具 二、持续集成是什么？简单说就是自动化的打包程序——如果是前端程序员，这样解释比较顺畅： 每次提交代码到 Github 的仓库后，Github 都会自动创建一个虚拟机（Mac &amp;#x2F; Wi"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://pic.ziyuan.wang/2023/08/23/bab4140e88a71.jpg"><meta property="article:author" content="Rookie_l"><meta property="article:tag" content="二次元 码农 地中海"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://pic.ziyuan.wang/2023/08/23/bab4140e88a71.jpg"><meta name="description" content="Github Action介绍一、Github Action 是什么？是 Github 推出的持续集成工具 二、持续集成是什么？简单说就是自动化的打包程序——如果是前端程序员，这样解释比较顺畅： 每次提交代码到 Github 的仓库后，Github 都会自动创建一个虚拟机（Mac &amp;#x2F; Wi"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://icu007work.github.io/archives/40fd71e7"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2023/09/03/125766904/ee23df8517f3c3e3efc4145658269c06_5714860933110284659.png"},
  postHeadAiDescription: {"enable":true,"gptName":"Rookie","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 你你你去哪啦??!","backTitle":"♪(^∇^*)你回来啦！"},
  LA51: {"enable":true,"ck":"3FfSkp1Eunbavgru","LingQueMonitorID":"3FfSkp1Eunbavgru"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: {"apiurl":"hexo-circle-of-friends-flax-ten.vercel.app/"},
  navMusic: true,
  mainTone: {"mode":"both","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":null},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"本文最后更新于","messageNext":"天前，其中的信息可能已经有所发展或是发生改变，请谨慎参考。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":true,"limitCount":50,"languages":{"author":"作者: Rookie_l","link":"链接: ","source":"来源: 米奇妙妙屋","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '米奇妙妙屋',
  title: 'Github Action实现Android自动打包并发布apk',
  postAI: '这篇文章主要介绍了GitHub Action的基本概念和使用方法，以下是文章的摘要：文章首先介绍了GitHub Action是什么，它是GitHub推出的一款持续集成工具，用于自动化构建、测试和部署代码。接着，解释了持续集成的概念，即自动化地执行特定的指令来构建程序，例如在前端项目中自动安装依赖并打包。Yaml文件在GitHub Action中的作用被提及，它是用于配置GitHub Action的文件，通常存放在存储库的根目录下的.github文件夹中。接下来，文章介绍了GitHub Action的一些使用限制，包括job执行时间、API请求限制等。关于Workflow，文章解释了它是由一个或多个job组成的自动化过程，通过创建Yaml文件来配置Workflow。在具体配置Workflow时，文章介绍了如何定义Workflow的名称和触发事件，以及如何定义job、job的名称、依赖关系、运行环境、环境变量等。对于job中的步骤（Step），文章解释了Step的属性，每个job由多个Step构成，每个Step可以运行命令、进行环境配置或执行Action。最后，文章提到了GitHub Action的Action，即可重用的命令集合，通过uses关键字引入，可以用于各种任务，比如代码检查、构建等。文章还介绍了如何使用Action库，如何传递参数以及如何运行命令行命令。总之，该文章详细介绍了GitHub Action的基本概念、配置方法和使用示例，适合初学者了解和入门GitHub Action的使用。',
  pageFillDescription: 'Github Action介绍, 一、Github Action 是什么？, 二、持续集成是什么？, 三、Yaml 是什么？, 四、Github Action 的使用限制, 五、什么是 Workflow？, 5.1 如何定义 Workflow 的名字？, 5.2 如何定义 Workflow 的触发器？, 六、Workflow 的 job 是什么？, 6.1 如何定义一个 job？, 6.2 如何定义 job 的名称？, 6.3 如何定义 job 的依赖？job 是否可以依赖于别的 job 的输出结果？, 6.4 如何定义 job 的运行环境？, 6.5 如何给 job 定义环境变量？, 6.6 如何使用 job 的条件控制语句？, 七、Step 属性是什么？, 7.1 step 运行的是什么？, 八、Action 是什么？, 8.1 我们应该如何使用 Action？, 8.2 上面我们为什么要用：@v2 和 @v2-beta 呢？, 8.3 上面的 with 参数是什么意思？, 九、我们如何运行命令行命令？, 9.1 如何运行多行命令？, 9.2 如何指定 command 运行的位置？, 9.3 如何指定 shell 的类型？（使用 cmd or powershell or python？？）, 十、什么是矩阵？, 如何用GitHub Action自动编译并且发布软件到 Release, 一、配置连接私有秘钥仓库的token, 二、配置 GitHub Action介绍一是什么是推出的持续集成工具二持续集成是什么简单说就是自动化的打包程序如果是前端程序员这样解释比较顺畅每次提交代码到的仓库后都会自动创建一个虚拟机任我们选来执行一段或多段指令由我们定例如三是什么我们集成的做法就是在我们仓库的根目录下创建一个文件夹里面放一个文件这个文件就是我们配置所用的文件四的使用限制每个中的最多可以执行个小时每个最多可以执行小时每个中的最多可以排队小时在一个存储库的所有中一个小时最多可以执行个请求并发工作数专业版可以最多提高到五什么是是由一个或多个组成的可配置的自动化过程我们通过创建文件来创建配置如何定义的名字的名称在存储库的页面上显示的名称如果我们省略则会将其设置为相对于存储库根目录的工作流文件路径如何定义的触发器触发执行的名称比如每当我提交代码到上的时候或者是每当我打的时候单个事件多个事件六的是什么答一个由一个或多个构成含义是一次持续集成的运行可以完成多个任务如何定义一个答通过的定义每个必须具有一个与之关联上面的和就是如何定义的名称会显示在上如何定义的依赖是否可以依赖于别的的输出结果答可以标识是否依赖于别的如果失败则会跳过所有需要该的用于和打配合输出输入的输出用于和打配合可以看到如何定义的运行环境指定运行的运行环境上可用的运行器为如何给定义环境变量如何使用的条件控制语句我们可以使用条件语句来组织运行七属性是什么答每个由多个构成它会从上至下依次执行运行的是什么可以运行命令行命令环境配置命令比如安装个环境安装个环境一段是什么我们后面再说每个都在自己的运行器环境中运行并且可以访问工作空间和文件系统因为每个都在运行器环境中独立运行所以之间不会保留对环境变量的更改定义的名字定义的触发器定义的定义的定义的定义的运行环境定义的运行步骤定义的名称定义的环境变量运行指令输出环境变量八是什么我们可以直接打开下面的市场来看看其实就是命令比如官方给了我们一些默认的命令比如最常用的代码到工作区我们应该如何使用库比如我们可以仓库中最新的代码到的工作区当然我们还可以给它添加个名字库再比如说我们如果是项目我们可以安装与上面我们为什么要用和呢答首先正如大家所想这个和的意思都是的版本我们如果不带版本号的话其实就是默认使用最新版本的了但是官方强烈要求我们带上版本号这样子的话我们就不会出现写好一个但是由于某个的作者一更新我们的就崩了的问题上面的参数是什么意思答有的可能会需要我们传入一些特定的值比如上面的版本啊之类的这些需要我们传入的参数由关键字来引入具体的需要传入哪些参数还请去中的页面中查看具体库的使用和参数我们可以去官方的市场查看市场九我们如何运行命令行命令上文说到可以运行和我们现在已经知道可以使用来运行了那么我们该如何运行呢答案是命令在默认状态下会启动一个没有登录的来作为命令输入器如何运行多行命令每个命令都会启动一个新的所以我们执行多行连续命令的时候需要写在同一个下单行命令多行命令如何指定运行的位置使用关键字我们可以指定的运行位置如何指定的类型使用使用关键字来指定特定的下面是各个系统支持的类型十什么是矩阵答就是有时候我们的代码可能编译环境有多个比如的程序我们需要在上编译压缩包在上编译可执行文件这种时候我们使用矩阵就可以啦比如下面的代码我们使用了矩阵指定了个操作系统个版本这时候下面这段代码就会执行次如何用自动编译并且发布软件到一配置连接私有秘钥仓库的首先点击然后选择依次选择生成新的后复制并保存下来在仓库的设置中依次选择新建一个名为的密钥并将第三步复制的粘贴进去二配置依次点击配置配置如下手动执行一次依次点击如下图所示后表明已经帮我们完成了编译发布这两个操作',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-23 15:56:26',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/mycss/charlie.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="米奇妙妙屋" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://icu007.work/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.png" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://chat.icu007.work/" title="ChatGPT"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.png" alt="ChatGPT"/><span class="back-menu-item-text">ChatGPT</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://baidu.icu007.work/" title="帮你百度一下"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.png" alt="帮你百度一下"/><span class="back-menu-item-text">帮你百度一下</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">米奇妙妙屋</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 站务</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 空调</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=6842714056&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 番剧</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 碎碎念</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 传送门</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" alt="wechat" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/wechat.jpg"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" alt="alipay" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/alipay.jpg"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Android/" style="font-size: 1.05rem;">Android<sup>2</sup></a><a href="/tags/Dos/" style="font-size: 1.05rem;">Dos<sup>1</sup></a><a href="/tags/IDEA/" style="font-size: 1.05rem;">IDEA<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>23</sup></a><a href="/tags/Java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" style="font-size: 1.05rem;">Java基础语法<sup>5</sup></a><a href="/tags/Java%E5%BC%82%E5%B8%B8/" style="font-size: 1.05rem;">Java异常<sup>2</sup></a><a href="/tags/Java%E6%95%B0%E7%BB%84/" style="font-size: 1.05rem;">Java数组<sup>3</sup></a><a href="/tags/Java%E6%96%B9%E6%B3%95/" style="font-size: 1.05rem;">Java方法<sup>1</sup></a><a href="/tags/Java%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/" style="font-size: 1.05rem;">Java流程控制<sup>3</sup></a><a href="/tags/Java%E7%89%B9%E6%80%A7/" style="font-size: 1.05rem;">Java特性<sup>1</sup></a><a href="/tags/Java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">Java面向对象<sup>4</sup></a><a href="/tags/Kotlin/" style="font-size: 1.05rem;">Kotlin<sup>13</sup></a><a href="/tags/Markdown/" style="font-size: 1.05rem;">Markdown<sup>1</sup></a><a href="/tags/WP/" style="font-size: 1.05rem;">WP<sup>1</sup></a><a href="/tags/git/" style="font-size: 1.05rem;">git<sup>2</sup></a><a href="/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" style="font-size: 1.05rem;">排序算法<sup>1</sup></a><a href="/tags/%E7%A1%AC%E4%BB%B6/" style="font-size: 1.05rem;">硬件<sup>1</sup></a><a href="/tags/%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8/" style="font-size: 1.05rem;">编程入门<sup>13</sup></a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 1.05rem;">设计模式<sup>2</sup></a><a href="/tags/%E8%BD%AF%E4%BB%B6%E5%88%86%E4%BA%AB/" style="font-size: 1.05rem;">软件分享<sup>1</sup></a><a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 1.05rem;">随笔<sup>13</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url">技术</a></span><span class="article-meta tags"></span></div></div><h1 class="post-title" itemprop="name headline">Github Action实现Android自动打包并发布apk</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2023-05-12T09:35:25.000Z" title="发表于 2023-05-12 17:35:25">2023-05-12</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2023-08-23T07:56:26.959Z" title="更新于 2023-08-23 15:56:26">2023-08-23</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">2.5k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>10分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="Github Action实现Android自动打包并发布apk"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为深圳"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>深圳</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://pic.ziyuan.wang/2023/08/23/bab4140e88a71.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div class="post-ai-description"><div class="ai-title"><i class="anzhiyufont anzhiyu-icon-bilibili"></i><div class="ai-title-text">AI-摘要</div><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i><i class="anzhiyufont anzhiyu-icon-circle-dot" title="朗读摘要"></i><div id="ai-tag">Rookie GPT</div></div><div class="ai-explanation">AI初始化中...</div><div class="ai-btn-box"><div class="ai-btn-item">介绍自己 🙈</div><div class="ai-btn-item">生成本文简介 👋</div><div class="ai-btn-item">推荐相关文章 📖</div><div class="ai-btn-item">前往主页 🏠</div><div class="ai-btn-item" id="go-tianli-blog">前往爱发电购买</div></div><script data-pjax src="/js/anzhiyu/ai_abstract.js"></script></div><article class="post-content" id="article-container" itemscope itemtype="https://icu007work.github.io/archives/40fd71e7.html"><header><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url">技术</a><h1 id="CrawlerTitle" itemprop="name headline">Github Action实现Android自动打包并发布apk</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Rookie_l</span><time itemprop="dateCreated datePublished" datetime="2023-05-12T09:35:25.000Z" title="发表于 2023-05-12 17:35:25">2023-05-12</time><time itemprop="dateCreated datePublished" datetime="2023-08-23T07:56:26.959Z" title="更新于 2023-08-23 15:56:26">2023-08-23</time></header><h2 id="Github-Action介绍"><a href="#Github-Action介绍" class="headerlink" title="Github Action介绍"></a>Github Action介绍</h2><h3 id="一、Github-Action-是什么？"><a href="#一、Github-Action-是什么？" class="headerlink" title="一、Github Action 是什么？"></a>一、Github Action 是什么？</h3><p>是 Github 推出的持续集成工具</p>
<h3 id="二、持续集成是什么？"><a href="#二、持续集成是什么？" class="headerlink" title="二、持续集成是什么？"></a>二、持续集成是什么？</h3><p>简单说就是自动化的打包程序——如果是前端程序员，这样解释比较顺畅：</p>
<p>每次提交代码到 Github 的仓库后，Github 都会自动创建一个虚拟机（Mac &#x2F; Windows &#x2F; Linux 任我们选），来执行一段或多段指令（由我们定），例如：</p>
<ol>
<li>npm install</li>
<li>npm run build</li>
</ol>
<h3 id="三、Yaml-是什么？"><a href="#三、Yaml-是什么？" class="headerlink" title="三、Yaml 是什么？"></a>三、Yaml 是什么？</h3><p>我们集成 Github Action 的做法，就是在我们仓库的根目录下，创建一个 .github 文件夹，里面放一个 *.yaml 文件——这个 Yaml 文件就是我们配置 Github Action 所用的文件。</p>
<h3 id="四、Github-Action-的使用限制"><a href="#四、Github-Action-的使用限制" class="headerlink" title="四、Github Action 的使用限制"></a>四、Github Action 的使用限制</h3><ul>
<li>每个 Workflow 中的 job 最多可以执行 6 个小时</li>
<li>每个 Workflow 最多可以执行 72 小时</li>
<li>每个 Workflow 中的 job 最多可以排队 24 小时</li>
<li>在一个存储库的所有 Action 中，一个小时最多可以执行 1000 个 API 请求</li>
<li>并发工作数：Linux：20，Mac：5（专业版可以最多提高到 180 &#x2F; 50）</li>
</ul>
<h3 id="五、什么是-Workflow？"><a href="#五、什么是-Workflow？" class="headerlink" title="五、什么是 Workflow？"></a>五、什么是 Workflow？</h3><p>Workflow 是由一个或多个 job 组成的可配置的自动化过程。我们通过创建 YAML 文件来创建 Workflow 配置。</p>
<hr>
<h4 id="5-1-如何定义-Workflow-的名字？"><a href="#5-1-如何定义-Workflow-的名字？" class="headerlink" title="5.1 如何定义 Workflow 的名字？"></a>5.1 如何定义 Workflow 的名字？</h4><blockquote>
<p>name</p>
</blockquote>
<p>Workflow 的名称，Github 在存储库的 Action 页面上显示 Workflow 的名称。</p>
<p>如果我们省略 name，则 Github 会将其设置为相对于存储库根目录的工作流文件路径。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name: Greeting from Mona</span><br><span class="line">on: push</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="5-2-如何定义-Workflow-的触发器？"><a href="#5-2-如何定义-Workflow-的触发器？" class="headerlink" title="5.2 如何定义 Workflow 的触发器？"></a>5.2 如何定义 Workflow 的触发器？</h4><blockquote>
<p>on</p>
</blockquote>
<p>触发 Workflow 执行的 event 名称，比如：<strong>每当我提交代码到 Github 上的时候，或者是每当我打 TAG 的时候。</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 单个事件</span><br><span class="line">on: push</span><br><span class="line"></span><br><span class="line">// 多个事件</span><br><span class="line">on: [push,pull_request]</span><br></pre></td></tr></table></figure>

<h3 id="六、Workflow-的-job-是什么？"><a href="#六、Workflow-的-job-是什么？" class="headerlink" title="六、Workflow 的 job 是什么？"></a>六、Workflow 的 job 是什么？</h3><p>答：一个 Workflow 由一个或多个 jobs 构成，含义是一次持续集成的运行，可以完成多个任务。</p>
<h4 id="6-1-如何定义一个-job？"><a href="#6-1-如何定义一个-job？" class="headerlink" title="6.1 如何定义一个 job？"></a>6.1 如何定义一个 job？</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jobs:</span><br><span class="line">  my_first_job:</span><br><span class="line">    name: My first job</span><br><span class="line">  my_second_job:</span><br><span class="line">    name: My second job</span><br></pre></td></tr></table></figure>

<p>答：通过 job 的 id 定义。</p>
<p>每个 job 必须具有一个 id 与之关联。</p>
<p>上面的 my_first_job 和 my_second_job 就是 job_id。</p>
<h4 id="6-2-如何定义-job-的名称？"><a href="#6-2-如何定义-job-的名称？" class="headerlink" title="6.2 如何定义 job 的名称？"></a>6.2 如何定义 job 的名称？</h4><blockquote>
<p>jobs.<job_id>.name</p>
</blockquote>
<p>name 会显示在 Github 上</p>
<h4 id="6-3-如何定义-job-的依赖？job-是否可以依赖于别的-job-的输出结果？"><a href="#6-3-如何定义-job-的依赖？job-是否可以依赖于别的-job-的输出结果？" class="headerlink" title="6.3 如何定义 job 的依赖？job 是否可以依赖于别的 job 的输出结果？"></a>6.3 如何定义 job 的依赖？job 是否可以依赖于别的 job 的输出结果？</h4><blockquote>
<p>jobs.<job_id>.needs</p>
</blockquote>
<p>答：needs 可以标识 job 是否依赖于别的 job——如果 job 失败，则会跳过所有需要该 job 的 job。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">jobs:</span><br><span class="line">  job1:</span><br><span class="line">  job2:</span><br><span class="line">    needs: job1</span><br><span class="line">  job3:</span><br><span class="line">    needs: [job1, job2]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>jobs.<jobs_id>.outputs：用于和 need 打配合，outputs 输出&#x3D;》need 输入</p>
</blockquote>
<p>jobs 的输出，用于和 needs 打配合：可以看到 ouput</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">jobs:</span><br><span class="line">  job1:</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    # Map a step output to a job output</span><br><span class="line">    outputs:</span><br><span class="line">      output1: $&#123;&#123; steps.step1.outputs.test &#125;&#125;</span><br><span class="line">      output2: $&#123;&#123; steps.step2.outputs.test &#125;&#125;</span><br><span class="line">    steps:</span><br><span class="line">    - id: step1</span><br><span class="line">      run: echo &quot;::set-output name=test::hello&quot;</span><br><span class="line">    - id: step2</span><br><span class="line">      run: echo &quot;::set-output name=test::world&quot;</span><br><span class="line">  job2:</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    needs: job1</span><br><span class="line">    steps:</span><br><span class="line">    - run: echo $&#123;&#123;needs.job1.outputs.output1&#125;&#125; $&#123;&#123;needs.job1.outputs.output2&#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-4-如何定义-job-的运行环境？"><a href="#6-4-如何定义-job-的运行环境？" class="headerlink" title="6.4 如何定义 job 的运行环境？"></a>6.4 如何定义 job 的运行环境？</h4><blockquote>
<p>jobs.<job_id>.runs-on</p>
</blockquote>
<p>指定运行 job 的运行环境，Github 上可用的运行器为：</p>
<ul>
<li>windows-2019</li>
<li>ubuntu-20.04</li>
<li>ubuntu-18.04</li>
<li>ubuntu-16.04</li>
<li>macos-10.15</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jobs:</span><br><span class="line">  job1:</span><br><span class="line">    runs-on: macos-10.15</span><br><span class="line">  job2:</span><br><span class="line">    runs-on: windows-2019</span><br></pre></td></tr></table></figure>

<h4 id="6-5-如何给-job-定义环境变量？"><a href="#6-5-如何给-job-定义环境变量？" class="headerlink" title="6.5 如何给 job 定义环境变量？"></a>6.5 如何给 job 定义环境变量？</h4><blockquote>
<p>jobs.<jobs_id>.env</p>
</blockquote>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jobs:</span><br><span class="line">  job1:</span><br><span class="line">    env:</span><br><span class="line">      FIRST_NAME: Mona</span><br></pre></td></tr></table></figure>

<h4 id="6-6-如何使用-job-的条件控制语句？"><a href="#6-6-如何使用-job-的条件控制语句？" class="headerlink" title="6.6 如何使用 job 的条件控制语句？"></a>6.6 如何使用 job 的条件控制语句？</h4><blockquote>
<p>jobs.<job_id>.if</p>
</blockquote>
<p>我们可以使用 if 条件语句来组织 job 运行</p>
<hr>
<h3 id="七、Step-属性是什么？"><a href="#七、Step-属性是什么？" class="headerlink" title="七、Step 属性是什么？"></a>七、Step 属性是什么？</h3><p>答：每个 job 由多个 step 构成，它会从上至下依次执行。</p>
<h4 id="7-1-step-运行的是什么？"><a href="#7-1-step-运行的是什么？" class="headerlink" title="7.1 step 运行的是什么？"></a>7.1 step 运行的是什么？</h4><p><strong>step 可以运行：</strong></p>
<ol>
<li><strong>command</strong>s：命令行命令</li>
<li><strong>setup tasks</strong>：环境配置命令（比如安装个 Node 环境、安装个 Python 环境）</li>
<li><strong>action</strong>（in your repository, in public repository, in Docker registry）：一段 action（Action 是什么我们后面再说）</li>
</ol>
<p><strong>每个 step 都在自己的运行器环境中运行，并且可以访问工作空间和文件系统。</strong></p>
<p>因为每个 step 都在运行器环境中独立运行，所以 <strong>step 之间不会保留对环境变量的更改</strong>。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># 定义 Workflow 的名字</span><br><span class="line">name: Greeting from Mona</span><br><span class="line"></span><br><span class="line"># 定义 Workflow 的触发器</span><br><span class="line">on: push</span><br><span class="line"></span><br><span class="line"># 定义 Workflow 的 job</span><br><span class="line">jobs:</span><br><span class="line">  # 定义 job 的 id</span><br><span class="line">  my-job:</span><br><span class="line">    # 定义 job 的 name</span><br><span class="line">    name: My Job</span><br><span class="line">    # 定义 job 的运行环境</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    # 定义 job 的运行步骤</span><br><span class="line">    steps:</span><br><span class="line">    # 定义 step 的名称</span><br><span class="line">    - name: Print a greeting</span><br><span class="line">      # 定义 step 的环境变量</span><br><span class="line">      env:</span><br><span class="line">        MY_VAR: Hi there! My name is</span><br><span class="line">        FIRST_NAME: Mona</span><br><span class="line">        MIDDLE_NAME: The</span><br><span class="line">        LAST_NAME: Octocat</span><br><span class="line">      # 运行指令：输出环境变量</span><br><span class="line">      run: |</span><br><span class="line">        echo $MY_VAR $FIRST_NAME $MIDDLE_NAME $LAST_NAME.</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="八、Action-是什么？"><a href="#八、Action-是什么？" class="headerlink" title="八、Action 是什么？"></a>八、Action 是什么？</h3><p>我们可以直接打开下面的 Action 市场来看看：</p>
<p><a href="https://link.zhihu.com/?target=https://github.com/marketplace?type=actions">https://github.com/marketplace?type=actionsgithub.com/marketplace?type=actions</a></p>
<p>Action 其实就是命令，比如 Github 官方给了我们一些默认的命令：</p>
<p><a href="https://link.zhihu.com/?target=https://github.com/marketplace?type=actions&query=actions">GitHub Marketplace: actions to improve your workflowgithub.com&#x2F;marketplace?type&#x3D;actions&amp;query&#x3D;actions<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic4.zhimg.com/v2-d06dfc50fef28a5c76fa9034fe797faf_180x120.jpg" alt="img"></a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.zhimg.com/80/v2-5208c22215435edfa36040d6b217c325_720w.webp" alt="img"></p>
<p>比如最常用的，check-out 代码到 Workflow 工作区：</p>
<p><a href="https://link.zhihu.com/?target=https://github.com/marketplace/actions/checkout">https://github.com/marketplace/actions/checkoutgithub.com/marketplace/actions/checkout</a></p>
<h4 id="8-1-我们应该如何使用-Action？"><a href="#8-1-我们应该如何使用-Action？" class="headerlink" title="8.1 我们应该如何使用 Action？"></a>8.1 我们应该如何使用 Action？</h4><blockquote>
<p>jobs.<job_id>.steps.uses</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic3.zhimg.com/80/v2-e6855fd2e091401590baf4febf356cce_720w.webp" alt="img"></p>
<p>Action 库：Checkout</p>
<p>比如我们可以 check-out 仓库中最新的代码到 Workflow 的工作区：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steps:</span><br><span class="line">  - uses: actions/checkout@v2</span><br></pre></td></tr></table></figure>

<p>当然，我们还可以给它添加个名字：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">steps:</span><br><span class="line">  - name: Check out Git repository</span><br><span class="line">    uses: actions/checkout@v2</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.zhimg.com/80/v2-8ea878b5f2917be32ba9aa18b3a1cef9_720w.webp" alt="img"></p>
<p>Action 库：Setup Node</p>
<p>再比如说，我们如果是 node 项目，我们可以安装 Node.js 与 NPM：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">steps:</span><br><span class="line">- uses: actions/checkout@v2</span><br><span class="line">- uses: actions/setup-node@v2-beta</span><br><span class="line">  with:</span><br><span class="line">    node-version: &#x27;12&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-上面我们为什么要用：-v2-和-v2-beta-呢？"><a href="#8-2-上面我们为什么要用：-v2-和-v2-beta-呢？" class="headerlink" title="8.2 上面我们为什么要用：@v2 和 @v2-beta 呢？"></a>8.2 上面我们为什么要用：@v2 和 @v2-beta 呢？</h4><p>答：首先，正如大家所想，这个 @v2 和 @v2-beta 的意思都是 Action 的版本。</p>
<p>我们如果不带版本号的话，其实就是默认使用最新版本的了。</p>
<p>但是 <strong>Github 官方强烈要求我们带上版本号</strong>——这样子的话，我们就不会出现：<strong>写好一个 Workflow，但是由于某个 Action 的作者一更新，我们的 Workflow 就崩了的问题。</strong></p>
<h4 id="8-3-上面的-with-参数是什么意思？"><a href="#8-3-上面的-with-参数是什么意思？" class="headerlink" title="8.3 上面的 with 参数是什么意思？"></a><strong>8.3 上面的 with 参数是什么意思？</strong></h4><p>答：<strong>有的 Action 可能会需要我们传入一些特定的值</strong>：比如上面的 node 版本啊之类的，这些<strong>需要我们传入的参数由 with 关键字来引入</strong>。</p>
<p><strong>具体的 Action 需要传入哪些参数，还请去 Github Action Market 中 Action 的页面中查看。</strong></p>
<p>具体库的使用和参数，我们可以去官方的 Action 市场查看：</p>
<p><a href="https://link.zhihu.com/?target=https://github.com/marketplace/actions/">Github Action 市场github.com&#x2F;marketplace&#x2F;actions&#x2F;</a></p>
<hr>
<h3 id="九、我们如何运行命令行命令？"><a href="#九、我们如何运行命令行命令？" class="headerlink" title="九、我们如何运行命令行命令？"></a>九、我们如何运行命令行命令？</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jobs.&lt;job_id&gt;.steps.run</span><br></pre></td></tr></table></figure>

<p>上文说到，<strong>steps 可以运行：action 和 command-line programs</strong>。</p>
<p>我们现在已经知道<strong>可以使用 uses 来运行 action 了</strong>，那么我们该如何运行 command-line programs 呢？</p>
<p><strong>答案是：run</strong></p>
<p><strong>run 命令在默认状态下会启动一个没有登录的 shell 来作为命令输入器。</strong></p>
<h4 id="9-1-如何运行多行命令？"><a href="#9-1-如何运行多行命令？" class="headerlink" title="9.1 如何运行多行命令？"></a><strong>9.1 如何运行多行命令？</strong></h4><p><strong>每个 run 命令都会启动一个新的 shell，所以我们执行多行连续命令的时候需要写在同一个 run 下：</strong></p>
<ul>
<li><strong>单行命令</strong></li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- name: Install Dependencies</span><br><span class="line">  run: npm install</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>多行命令</strong></li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- name: Clean install dependencies and build</span><br><span class="line">  run： |</span><br><span class="line">    npm ci</span><br><span class="line">    npm run build</span><br></pre></td></tr></table></figure>



<h4 id="9-2-如何指定-command-运行的位置？"><a href="#9-2-如何指定-command-运行的位置？" class="headerlink" title="9.2 如何指定 command 运行的位置？"></a>9.2 如何指定 command 运行的位置？</h4><p>使用 working-directory 关键字，我们可以指定 command 的运行位置：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- name: Clean temp directory</span><br><span class="line">  run: rm -rf *</span><br><span class="line">  working-directory: ./temp</span><br></pre></td></tr></table></figure>



<h4 id="9-3-如何指定-shell-的类型？（使用-cmd-or-powershell-or-python？？）"><a href="#9-3-如何指定-shell-的类型？（使用-cmd-or-powershell-or-python？？）" class="headerlink" title="9.3 如何指定 shell 的类型？（使用 cmd or powershell or python？？）"></a>9.3 如何指定 shell 的类型？（使用 cmd or powershell or python？？）</h4><p>使用 shell 关键字，来指定特定的 shell：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">steps:</span><br><span class="line">  - name: Display the path</span><br><span class="line">    run: echo $PATH</span><br><span class="line">    shell: bash</span><br></pre></td></tr></table></figure>

<p>下面是各个系统支持的 shell 类型：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.zhimg.com/80/v2-9283bfe170157cf550cbc86c36fa28c5_720w.webp" alt="img"></p>
<hr>
<h3 id="十、什么是矩阵？"><a href="#十、什么是矩阵？" class="headerlink" title="十、什么是矩阵？"></a>十、什么是矩阵？</h3><p>答：就是有时候，我们的代码可能编译环境有多个。比如 electron 的程序，我们需要在 macos 上编译 dmg 压缩包，在 windows 上编译 exe 可执行文件。</p>
<p><strong>这种时候，我们使用矩阵就可以啦~</strong></p>
<p>比如下面的代码，我们使用了矩阵指定了：<strong>2 个操作系统，3 个 node 版本</strong>。</p>
<p>这时候<strong>下面这段代码就会执行 6 次</strong>—— 2 x 3 &#x3D; 6！！！</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">runs-on: $&#123;&#123; matrix.os &#125;&#125;</span><br><span class="line">strategy:</span><br><span class="line">  matrix:</span><br><span class="line">    os: [ubuntu-16.04, ubuntu-18.04]</span><br><span class="line">    node: [6, 8, 10]</span><br><span class="line">steps:</span><br><span class="line">  - uses: actions/setup-node@v1</span><br><span class="line">    with:</span><br><span class="line">      node-version: $&#123;&#123; matrix.node &#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="如何用GitHub-Action自动编译并且发布软件到-Release"><a href="#如何用GitHub-Action自动编译并且发布软件到-Release" class="headerlink" title="如何用GitHub Action自动编译并且发布软件到 Release"></a>如何用GitHub Action自动编译并且发布软件到 Release</h2><h3 id="一、配置连接私有秘钥仓库的token"><a href="#一、配置连接私有秘钥仓库的token" class="headerlink" title="一、配置连接私有秘钥仓库的token"></a>一、配置连接私有秘钥仓库的token</h3><ol>
<li>首先点击 <code>Settings</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p1.meituan.net/csc/fe431f6c5e071351005b8f960891b1a539243.png" alt="image.png"></p>
<ol start="2">
<li>然后选择<code>Developer settings</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p0.meituan.net/csc/43fff60e59380a738053cdd60ed0e1f7279525.png" alt="image.png"></p>
<ol start="3">
<li>依次选择<code>Tokens</code> -&gt; <code>generate new token</code>生成新的token后复制并保存下来。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p1.meituan.net/csc/af9948599cade116963039b4f6897988176494.png" alt="image.png"></p>
<ol start="4">
<li>在仓库的设置中依次选择 <code>Settings</code> -&gt; <code>Secrets and variables</code> -&gt; <code>Action</code> -&gt; <code>new repository secret</code>新建一个名为TOKEN的密钥，并将第三步复制的token粘贴进去。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p0.meituan.net/csc/f381faeac8abed51ad36adee738ef4d7336383.png" alt="image.png"></p>
<h3 id="二、配置-GitHub-Action"><a href="#二、配置-GitHub-Action" class="headerlink" title="二、配置 GitHub Action"></a>二、配置 GitHub Action</h3><ol>
<li>依次点击 <code>Action</code> -&gt; <code>Android CI</code> -&gt; <code>Configure</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p0.meituan.net/csc/f2d6e561835f7aa369fde4574259892f374070.png" alt="image.png"></p>
<ol start="2">
<li>配置 <code>android.yml</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p0.meituan.net/csc/c210d15c2d5069928b0cd2072e8366d3274932.png" alt="image.png"></p>
<ul>
<li><code>android.yml</code>配置如下</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Build</span> <span class="string">and</span> <span class="string">Release</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line"> <span class="attr">push:</span></span><br><span class="line">   <span class="attr">branches:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;feature/*&quot;</span></span><br><span class="line">   <span class="attr">tags:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;v*.*.*&quot;</span></span><br><span class="line"> <span class="attr">pull_request:</span></span><br><span class="line">   <span class="attr">branches:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;feature/*&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line"> <span class="attr">apk:</span></span><br><span class="line">   <span class="attr">name:</span> <span class="string">Generate</span> <span class="string">APK</span></span><br><span class="line">   <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">   <span class="attr">steps:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/checkout@v2.4.0</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Branch</span> <span class="string">name</span></span><br><span class="line">       <span class="attr">run:</span> <span class="string">echo</span> <span class="string">running</span> <span class="string">on</span> <span class="string">branch</span> <span class="string">$&#123;GITHUB_REF##*/&#125;</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">JDK</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/setup-java@v2.5.0</span></span><br><span class="line">       <span class="attr">with:</span></span><br><span class="line">         <span class="attr">distribution:</span> <span class="string">temurin</span></span><br><span class="line">         <span class="attr">java-version:</span> <span class="string">&quot;11&quot;</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">execution</span> <span class="string">flag</span> <span class="string">for</span> <span class="string">gradlew</span></span><br><span class="line">       <span class="attr">run:</span> <span class="string">chmod</span> <span class="string">+x</span> <span class="string">gradlew</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">APK</span></span><br><span class="line">       <span class="attr">run:</span> <span class="string">bash</span> <span class="string">./gradlew</span> <span class="string">assembleDebug</span> <span class="string">--stacktrace</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">APK</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/upload-artifact@v1</span></span><br><span class="line">       <span class="attr">with:</span></span><br><span class="line">         <span class="attr">name:</span> <span class="string">apk</span></span><br><span class="line">         <span class="attr">path:</span> <span class="string">app/build/outputs/apk/debug/app-debug.apk</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">release:</span></span><br><span class="line">   <span class="attr">name:</span> <span class="string">Release</span> <span class="string">APK</span></span><br><span class="line">   <span class="attr">needs:</span> <span class="string">apk</span></span><br><span class="line">   <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">   <span class="attr">steps:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Get</span> <span class="string">branch</span> <span class="string">name</span></span><br><span class="line">       <span class="attr">id:</span> <span class="string">branch-name</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">tj-actions/branch-names@v5.1</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Print</span> <span class="string">branch</span>    </span><br><span class="line">       <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">         echo &quot;Running on default: $&#123;&#123; steps.branch-name.outputs.current_branch &#125;&#125;&quot;</span></span><br><span class="line"><span class="string"></span>       </span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Download</span> <span class="string">APK</span> <span class="string">from</span> <span class="string">build</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/download-artifact@v1</span></span><br><span class="line">       <span class="attr">with:</span></span><br><span class="line">         <span class="attr">name:</span> <span class="string">apk</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">Release</span></span><br><span class="line">       <span class="attr">id:</span> <span class="string">create_release</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/create-release@v1</span></span><br><span class="line">       <span class="attr">env:</span></span><br><span class="line">         <span class="attr">GITHUB_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">       <span class="attr">with:</span></span><br><span class="line">         <span class="attr">tag_name:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.run_number</span> <span class="string">&#125;&#125;</span></span><br><span class="line">         <span class="attr">release_name:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.repository.name</span> <span class="string">&#125;&#125;</span>  <span class="string">$&#123;&#123;</span> <span class="string">steps.branch-name.outputs.current_branch</span> <span class="string">&#125;&#125;</span> <span class="string">v$&#123;&#123;</span> <span class="string">github.run_number</span> <span class="string">&#125;&#125;.$&#123;&#123;</span> <span class="string">github.run_attempt</span> <span class="string">&#125;&#125;</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">Release</span> <span class="string">APK</span></span><br><span class="line">       <span class="attr">id:</span> <span class="string">upload_release_asset</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/upload-release-asset@v1.0.1</span></span><br><span class="line">       <span class="attr">env:</span></span><br><span class="line">         <span class="attr">GITHUB_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">       <span class="attr">with:</span></span><br><span class="line">         <span class="attr">upload_url:</span> <span class="string">$&#123;&#123;</span> <span class="string">steps.create_release.outputs.upload_url</span> <span class="string">&#125;&#125;</span></span><br><span class="line">         <span class="attr">asset_path:</span> <span class="string">apk/app-debug.apk</span></span><br><span class="line">         <span class="attr">asset_name:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.repository.name</span> <span class="string">&#125;&#125;</span>  <span class="string">$&#123;&#123;</span> <span class="string">steps.branch-name.outputs.current_branch</span> <span class="string">&#125;&#125;</span> <span class="string">v$&#123;&#123;</span> <span class="string">github.run_number</span> <span class="string">&#125;&#125;.$&#123;&#123;</span> <span class="string">github.run_attempt</span> <span class="string">&#125;&#125;.apk</span></span><br><span class="line">         <span class="attr">asset_content_type:</span> <span class="string">application/zip</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>手动执行一次<code>Action</code> 依次点击 <code>Action</code> -&gt; <code>Build and Release</code> -&gt; <code>Update android.yml</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p0.meituan.net/csc/e1dbb65ea6a7f7de21d6c9d0730d19d3205339.png" alt="image.png"></p>
<ol start="4">
<li>如下图所示后，表明Action 已经帮我们完成了编译-发布这两个操作。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p1.meituan.net/csc/3fe33a7c8b4f494fbab499b98545674f324900.png" alt="image.png"></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Rookie_l</div><div class="post-copyright__author_desc">偷得浮生半日闲</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://icu007work.github.io/archives/40fd71e7.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://icu007work.github.io/archives/40fd71e7.html')">Github Action实现Android自动打包并发布apk</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://icu007work.github.io/archives/40fd71e7.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Github Action实现Android自动打包并发布apk&amp;url=https://icu007work.github.io/archives/40fd71e7.html&amp;pic=https://pic.ziyuan.wang/2023/08/23/bab4140e88a71.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://icu007work.github.io" target="_blank">米奇妙妙屋</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"></div></div></div><div class="post_share"><div class="social-share" data-image="https://pic2.ziyuan.wang/user/xiheya/2024/05/Kotlin-Advance_535ea90c69f3c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/archives/5e339248.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.ziyuan.wang/2023/08/23/c4bfc940f3cac.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Typora快捷键</div></div></a></div><div class="next-post pull-right"><a href="/archives/5d597b5d.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.ziyuan.wang/2023/08/23/42cbb98bf5698.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Hexo发布文章指北</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">本站有关于<b style="color:#fff">科技、生活</b>相关的文章和随笔，还有<b style="color:#fff">编程基础知识</b>和<b style="color:#fff">实用工具</b>分享。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">希望你可以在本站中收获对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Rookie_l</h1><div class="author-info__desc">偷得浮生半日闲</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/hiheya" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/55406380" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://pic.ziyuan.wang/2023/08/22/30087e712d9fd.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://pic.ziyuan.wang/2023/08/22/e91ab86cccd2c.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Github-Action%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">Github Action介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81Github-Action-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">一、Github Action 是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">二、持续集成是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81Yaml-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.3.</span> <span class="toc-text">三、Yaml 是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81Github-Action-%E7%9A%84%E4%BD%BF%E7%94%A8%E9%99%90%E5%88%B6"><span class="toc-number">1.4.</span> <span class="toc-text">四、Github Action 的使用限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF-Workflow%EF%BC%9F"><span class="toc-number">1.5.</span> <span class="toc-text">五、什么是 Workflow？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89-Workflow-%E7%9A%84%E5%90%8D%E5%AD%97%EF%BC%9F"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 如何定义 Workflow 的名字？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89-Workflow-%E7%9A%84%E8%A7%A6%E5%8F%91%E5%99%A8%EF%BC%9F"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 如何定义 Workflow 的触发器？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD%E3%80%81Workflow-%E7%9A%84-job-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.6.</span> <span class="toc-text">六、Workflow 的 job 是什么？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA-job%EF%BC%9F"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 如何定义一个 job？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89-job-%E7%9A%84%E5%90%8D%E7%A7%B0%EF%BC%9F"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 如何定义 job 的名称？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89-job-%E7%9A%84%E4%BE%9D%E8%B5%96%EF%BC%9Fjob-%E6%98%AF%E5%90%A6%E5%8F%AF%E4%BB%A5%E4%BE%9D%E8%B5%96%E4%BA%8E%E5%88%AB%E7%9A%84-job-%E7%9A%84%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C%EF%BC%9F"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 如何定义 job 的依赖？job 是否可以依赖于别的 job 的输出结果？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89-job-%E7%9A%84%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83%EF%BC%9F"><span class="toc-number">1.6.4.</span> <span class="toc-text">6.4 如何定义 job 的运行环境？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-%E5%A6%82%E4%BD%95%E7%BB%99-job-%E5%AE%9A%E4%B9%89%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%EF%BC%9F"><span class="toc-number">1.6.5.</span> <span class="toc-text">6.5 如何给 job 定义环境变量？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-job-%E7%9A%84%E6%9D%A1%E4%BB%B6%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5%EF%BC%9F"><span class="toc-number">1.6.6.</span> <span class="toc-text">6.6 如何使用 job 的条件控制语句？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%83%E3%80%81Step-%E5%B1%9E%E6%80%A7%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.7.</span> <span class="toc-text">七、Step 属性是什么？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-step-%E8%BF%90%E8%A1%8C%E7%9A%84%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 step 运行的是什么？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AB%E3%80%81Action-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.8.</span> <span class="toc-text">八、Action 是什么？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-%E6%88%91%E4%BB%AC%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-Action%EF%BC%9F"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 我们应该如何使用 Action？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-%E4%B8%8A%E9%9D%A2%E6%88%91%E4%BB%AC%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%EF%BC%9A-v2-%E5%92%8C-v2-beta-%E5%91%A2%EF%BC%9F"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2 上面我们为什么要用：@v2 和 @v2-beta 呢？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-3-%E4%B8%8A%E9%9D%A2%E7%9A%84-with-%E5%8F%82%E6%95%B0%E6%98%AF%E4%BB%80%E4%B9%88%E6%84%8F%E6%80%9D%EF%BC%9F"><span class="toc-number">1.8.3.</span> <span class="toc-text">8.3 上面的 with 参数是什么意思？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E6%88%91%E4%BB%AC%E5%A6%82%E4%BD%95%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%9F"><span class="toc-number">1.9.</span> <span class="toc-text">九、我们如何运行命令行命令？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-%E5%A6%82%E4%BD%95%E8%BF%90%E8%A1%8C%E5%A4%9A%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%9F"><span class="toc-number">1.9.1.</span> <span class="toc-text">9.1 如何运行多行命令？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-%E5%A6%82%E4%BD%95%E6%8C%87%E5%AE%9A-command-%E8%BF%90%E8%A1%8C%E7%9A%84%E4%BD%8D%E7%BD%AE%EF%BC%9F"><span class="toc-number">1.9.2.</span> <span class="toc-text">9.2 如何指定 command 运行的位置？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-3-%E5%A6%82%E4%BD%95%E6%8C%87%E5%AE%9A-shell-%E7%9A%84%E7%B1%BB%E5%9E%8B%EF%BC%9F%EF%BC%88%E4%BD%BF%E7%94%A8-cmd-or-powershell-or-python%EF%BC%9F%EF%BC%9F%EF%BC%89"><span class="toc-number">1.9.3.</span> <span class="toc-text">9.3 如何指定 shell 的类型？（使用 cmd or powershell or python？？）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E7%9F%A9%E9%98%B5%EF%BC%9F"><span class="toc-number">1.10.</span> <span class="toc-text">十、什么是矩阵？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E7%94%A8GitHub-Action%E8%87%AA%E5%8A%A8%E7%BC%96%E8%AF%91%E5%B9%B6%E4%B8%94%E5%8F%91%E5%B8%83%E8%BD%AF%E4%BB%B6%E5%88%B0-Release"><span class="toc-number">2.</span> <span class="toc-text">如何用GitHub Action自动编译并且发布软件到 Release</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E9%85%8D%E7%BD%AE%E8%BF%9E%E6%8E%A5%E7%A7%81%E6%9C%89%E7%A7%98%E9%92%A5%E4%BB%93%E5%BA%93%E7%9A%84token"><span class="toc-number">2.1.</span> <span class="toc-text">一、配置连接私有秘钥仓库的token</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E9%85%8D%E7%BD%AE-GitHub-Action"><span class="toc-number">2.2.</span> <span class="toc-text">二、配置 GitHub Action</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/archives/4fa27f9d.html" title="Kotlin 进阶"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.ziyuan.wang/user/xiheya/2024/05/Kotlin-Advance_535ea90c69f3c.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kotlin 进阶"/></a><div class="content"><a class="title" href="/archives/4fa27f9d.html" title="Kotlin 进阶">Kotlin 进阶</a><time datetime="2024-05-11T07:40:52.000Z" title="发表于 2024-05-11 15:40:52">2024-05-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/4a483fcb.html" title="Kotlin安卓开发-使用网络技术"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.ziyuan.wang/user/xiheya/2024/05/Network_0d14f49c4bca7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kotlin安卓开发-使用网络技术"/></a><div class="content"><a class="title" href="/archives/4a483fcb.html" title="Kotlin安卓开发-使用网络技术">Kotlin安卓开发-使用网络技术</a><time datetime="2024-03-13T07:37:24.000Z" title="发表于 2024-03-13 15:37:24">2024-03-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/a3762f06.html" title="Kotlin安卓开发-Material"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.ziyuan.wang/user/xiheya/2024/05/Material_c668a539b4551.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kotlin安卓开发-Material"/></a><div class="content"><a class="title" href="/archives/a3762f06.html" title="Kotlin安卓开发-Material">Kotlin安卓开发-Material</a><time datetime="2024-02-27T07:34:17.000Z" title="发表于 2024-02-27 15:34:17">2024-02-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/6c099795.html" title="Kotlin安卓开发-高级技巧"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.ziyuan.wang/user/xiheya/2024/05/Advance_7270c77bc7e69.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kotlin安卓开发-高级技巧"/></a><div class="content"><a class="title" href="/archives/6c099795.html" title="Kotlin安卓开发-高级技巧">Kotlin安卓开发-高级技巧</a><time datetime="2024-02-04T07:31:01.000Z" title="发表于 2024-02-04 15:31:01">2024-02-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/f8eec5a0.html" title="Kotlin安卓开发-Jetpack"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.ziyuan.wang/user/xiheya/2024/05/Jetpack_cb169f472cca5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kotlin安卓开发-Jetpack"/></a><div class="content"><a class="title" href="/archives/f8eec5a0.html" title="Kotlin安卓开发-Jetpack">Kotlin安卓开发-Jetpack</a><time datetime="2024-01-24T07:28:13.000Z" title="发表于 2024-01-24 15:28:13">2024-01-24</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:rookie_l@icu007.work" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com/u/5400016811" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=61550101473898&amp;mibextid=2JQ9oc" title="facebook"><i class="anzhiyufont anzhiyu-icon-facebook1"></i></a><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/hiheya" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/55406380" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://v.douyin.com/iJm1hSu7/" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral/" title="本网站由 又拍云 提供CDN加速/云存储服务"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-upyun"></use></svg></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="51la统计" target="_blank" rel="noopener" href="https://v6.51.la/">51la统计</a><a class="footer-item" title="十年之约" target="_blank" rel="noopener" href="https://www.foreverblog.cn/">十年之约</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a><a class="footer-item" title="本网站由 又拍云 提供CDN加速/云存储服务" target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral/">本网站由 又拍云 提供CDN加速/云存储服务</a></div></div><div class="footer-group"><div class="footer-title">关于</div><div class="footer-links"><a class="footer-item" title="关于作者" href="/about/">关于作者</a><a class="footer-item" title="文章归档" href="/archives/">文章归档</a><a class="footer-item" title="更新日志" href="/update/">更新日志</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a><a class="footer-item" title="友链文章" href="/fcircle/">友链文章</a><a class="footer-item" title="留言板" href="/comments/">留言板</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies" href="/cookies/">Cookies</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral/" style="margin-inline:5px" data-title="本站使用又拍云为静态资源提供CDN加速" title="本站使用又拍云为静态资源提供CDN加速"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shields.io/badge/CDN-又拍云-blue.svg?logo=iCloud" alt="本站使用又拍云为静态资源提供CDN加速"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="Rookie_l" target="_blank">Rookie_l</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = ["尊重所有声音&#44; 但成为自己."]
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#footer-type-tips', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('footer-type-tips').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://icu007.work" title="主站">主站</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">4</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://icu007.work/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.png" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://chat.icu007.work/" title="ChatGPT"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.png" alt="ChatGPT"/><span class="back-menu-item-text">ChatGPT</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://baidu.icu007.work/" title="帮你百度一下"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.png" alt="帮你百度一下"/><span class="back-menu-item-text">帮你百度一下</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 站务</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 空调</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=6842714056&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 番剧</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 碎碎念</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 传送门</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Android/" style="font-size: 0.88rem;">Android<sup>2</sup></a><a href="/tags/Dos/" style="font-size: 0.88rem;">Dos<sup>1</sup></a><a href="/tags/IDEA/" style="font-size: 0.88rem;">IDEA<sup>1</sup></a><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>23</sup></a><a href="/tags/Java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" style="font-size: 0.88rem;">Java基础语法<sup>5</sup></a><a href="/tags/Java%E5%BC%82%E5%B8%B8/" style="font-size: 0.88rem;">Java异常<sup>2</sup></a><a href="/tags/Java%E6%95%B0%E7%BB%84/" style="font-size: 0.88rem;">Java数组<sup>3</sup></a><a href="/tags/Java%E6%96%B9%E6%B3%95/" style="font-size: 0.88rem;">Java方法<sup>1</sup></a><a href="/tags/Java%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/" style="font-size: 0.88rem;">Java流程控制<sup>3</sup></a><a href="/tags/Java%E7%89%B9%E6%80%A7/" style="font-size: 0.88rem;">Java特性<sup>1</sup></a><a href="/tags/Java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">Java面向对象<sup>4</sup></a><a href="/tags/Kotlin/" style="font-size: 0.88rem;">Kotlin<sup>13</sup></a><a href="/tags/Markdown/" style="font-size: 0.88rem;">Markdown<sup>1</sup></a><a href="/tags/WP/" style="font-size: 0.88rem;">WP<sup>1</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>2</sup></a><a href="/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" style="font-size: 0.88rem;">排序算法<sup>1</sup></a><a href="/tags/%E7%A1%AC%E4%BB%B6/" style="font-size: 0.88rem;">硬件<sup>1</sup></a><a href="/tags/%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8/" style="font-size: 0.88rem;">编程入门<sup>13</sup></a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 0.88rem;">设计模式<sup>2</sup></a><a href="/tags/%E8%BD%AF%E4%BB%B6%E5%88%86%E4%BA%AB/" style="font-size: 0.88rem;">软件分享<sup>1</sup></a><a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 0.88rem;">随笔<sup>13</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="6842714056" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/#/playlist?id=6842714056&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'DSKC4Zc0A0aO83qSYyJIczkF-gzGzoHsz',
      appKey: 'X4vG5DxFgvkzTBQNF8IRA7gi',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, {"valine":"/js/myjs/Valine.min.js"}))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('/js/myjs/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script src="https://cdn.cbd.int/blueimp-md5@2.19.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=monsterid'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://DSKC4Zc0.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": 'DSKC4Zc0A0aO83qSYyJIczkF-gzGzoHsz',
        "X-LC-Key": 'X4vG5DxFgvkzTBQNF8IRA7gi',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async src="https://at.alicdn.com/t/c/font_4201142_cetcbzr9wn.js"></script><script type="text/javascript" src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>