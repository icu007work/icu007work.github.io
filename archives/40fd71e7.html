<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Github Action实现Android自动打包并发布apk | 米奇妙妙屋</title><meta name="keywords" content="二次元 码农 地中海"><meta name="author" content="Rookie_l"><meta name="copyright" content="Rookie_l"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Github Action实现Android自动打包并发布apk"><meta name="application-name" content="Github Action实现Android自动打包并发布apk"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Github Action实现Android自动打包并发布apk"><meta property="og:url" content="https://icu007work.github.io/archives/40fd71e7.html"><meta property="og:site_name" content="米奇妙妙屋"><meta property="og:description" content="Github Action介绍一、Github Action 是什么？是 Github 推出的持续集成工具 二、持续集成是什么？简单说就是自动化的打包程序——如果是前端程序员，这样解释比较顺畅： 每次提交代码到 Github 的仓库后，Github 都会自动创建一个虚拟机（Mac &amp;#x2F; Wi"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://pic.ziyuan.wang/2023/08/23/bab4140e88a71.jpg"><meta property="article:author" content="Rookie_l"><meta property="article:tag" content="二次元 码农 地中海"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://pic.ziyuan.wang/2023/08/23/bab4140e88a71.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://icu007work.github.io/archives/40fd71e7"><link rel="preconnect" href="//npm.elemecdn.com"/><link rel="preconnect" href="//npm.onmicrosoft.cn"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.14/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  preloader: {"source":3},
  friends_vue_info: {"apiurl":"hexo-circle-of-friends-flax-ten.vercel.app/"},
  navMusic: true,
  mainTone: {"mode":"both","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":null},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"本文最后更新于","messageNext":"天前，其中的信息可能已经有所发展或是发生改变，请谨慎参考。"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Rookie_l","link":"链接: ","source":"来源: 米奇妙妙屋","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Github Action实现Android自动打包并发布apk',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-23 15:56:26',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/mycss/charlie.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="米奇妙妙屋" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg"/><div class="loading-image-dot"></div><div id="loading-percentage">0%</div></div></div><script>if (GLOBAL_CONFIG.preloader.source == "2" || GLOBAL_CONFIG.preloader.source == "3") {
  const loadingPercentage = document.getElementById("loading-percentage");
  let loadingPercentageTimer = setInterval(function() {
    var progressBar = document.querySelector(".pace-progress");
    if (!progressBar) return
    var currentValue = progressBar.getAttribute("data-progress-text");
    if (currentValue !== loadingPercentage.textContent) {
      loadingPercentage.textContent = currentValue;
      if (currentValue === "100%") {
        clearInterval(loadingPercentageTimer);
      }
    }
  }, 100);
}

const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div id="web_box"><div id="web_container"><div id="menu-mask"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://icu007.work/" title="博客" target="_blank"><img class="back-menu-item-icon" src="/img/favicon.png" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" href="https://chat.icu007.work/" title="ChatGPT" target="_blank"><img class="back-menu-item-icon" src="/img/favicon.png" alt="ChatGPT"/><span class="back-menu-item-text">ChatGPT</span></a><a class="back-menu-item" href="https://baidu.icu007.work/" title="帮你百度一下" target="_blank"><img class="back-menu-item-icon" src="/img/favicon.png" alt="帮你百度一下"/><span class="back-menu-item-text">帮你百度一下</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">米奇妙妙屋</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 站务</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 空调</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=6842714056&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 番剧</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 碎碎念</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 传送门</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" alt="wechat" src="/img/wechat.jpg"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" alt="alipay" src="/img/alipay.jpg"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> <span>最新评论</span></span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Android/" style="font-size: 1.05rem;">Android<sup>2</sup></a><a href="/tags/Dos/" style="font-size: 1.05rem;">Dos<sup>1</sup></a><a href="/tags/IDEA/" style="font-size: 1.05rem;">IDEA<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>23</sup></a><a href="/tags/Java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" style="font-size: 1.05rem;">Java基础语法<sup>5</sup></a><a href="/tags/Java%E5%BC%82%E5%B8%B8/" style="font-size: 1.05rem;">Java异常<sup>2</sup></a><a href="/tags/Java%E6%95%B0%E7%BB%84/" style="font-size: 1.05rem;">Java数组<sup>3</sup></a><a href="/tags/Java%E6%96%B9%E6%B3%95/" style="font-size: 1.05rem;">Java方法<sup>1</sup></a><a href="/tags/Java%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/" style="font-size: 1.05rem;">Java流程控制<sup>3</sup></a><a href="/tags/Java%E7%89%B9%E6%80%A7/" style="font-size: 1.05rem;">Java特性<sup>1</sup></a><a href="/tags/Java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">Java面向对象<sup>4</sup></a><a href="/tags/Kotlin/" style="font-size: 1.05rem;">Kotlin<sup>1</sup></a><a href="/tags/Markdown/" style="font-size: 1.05rem;">Markdown<sup>1</sup></a><a href="/tags/WP/" style="font-size: 1.05rem;">WP<sup>1</sup></a><a href="/tags/git/" style="font-size: 1.05rem;">git<sup>2</sup></a><a href="/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" style="font-size: 1.05rem;">排序算法<sup>1</sup></a><a href="/tags/%E7%A1%AC%E4%BB%B6/" style="font-size: 1.05rem;">硬件<sup>1</sup></a><a href="/tags/%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8/" style="font-size: 1.05rem;">编程入门<sup>1</sup></a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 1.05rem;">设计模式<sup>2</sup></a><a href="/tags/%E8%BD%AF%E4%BB%B6%E5%88%86%E4%BA%AB/" style="font-size: 1.05rem;">软件分享<sup>1</sup></a><a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 1.05rem;">随笔<sup>13</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/09/"><span class="card-archive-list-date">九月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/08/"><span class="card-archive-list-date">八月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">38</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" onclick="anzhiyu.switchDarkMode()" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="article-meta tags"></span></div></div><h1 class="post-title">Github Action实现Android自动打包并发布apk</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-05-12T09:35:25.000Z" title="发表于 2023-05-12 17:35:25">2023-05-12</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-08-23T07:56:26.959Z" title="更新于 2023-08-23 15:56:26">2023-08-23</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">2.5k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>10分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="Github Action实现Android自动打包并发布apk"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为深圳"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>深圳</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://pic.ziyuan.wang/2023/08/23/bab4140e88a71.jpg"></div></header><main class="layout" id="content-inner"><div id="post"><div class="post-ai-description"><div class="ai-title"><i class="anzhiyufont anzhiyu-icon-bilibili"></i><div class="ai-title-text">AI-摘要</div><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i><div id="ai-tag">Rookie GPT</div></div><div class="ai-explanation">AI初始化中...</div><div class="ai-btn-box"><div class="ai-btn-item">介绍自己</div><div class="ai-btn-item">生成本文简介</div><div class="ai-btn-item">推荐相关文章</div><div class="ai-btn-item">前往主页</div><div class="ai-btn-item" id="go-tianli-blog">前往tianli博客</div></div><script data-pjax>(function(){
  // 当前随机到的ai摘要到index
  let lastAiRandomIndex = -1;
  let animationRunning = true; // 标志变量，控制动画函数的运行
  // 当前gpt模式
  let mode = "local"
  // 刷新点击次数
  let refreshNum = 0
  // 记录上一次传递给aiAbstract的参数
  let prevParam;
  const aiTitleRefreshIcon = document.querySelector(".ai-title .anzhiyufont.anzhiyu-icon-arrow-rotate-right")
  const explanation = document.querySelector(".ai-explanation");
  const post_ai = document.querySelector(".post-ai-description");
  let ai_str = "";
  let ai_str_length = "";
  let delay_init = 600;
  let i = 0;
  let j = 0;
  let sto = [];
  let elapsed = 0;
  const animate = timestamp => {
    if (!animationRunning) {
      return; // 动画函数停止运行
    }
    if (!animate.start) animate.start = timestamp;
    elapsed = timestamp - animate.start;
    if (elapsed >= 20) {
      animate.start = timestamp;
      if (i < ai_str_length - 1) {
        let char = ai_str.charAt(i + 1);
        let delay = /[,.，。!?！？]/.test(char) ? 150 : 20;
        if (explanation.firstElementChild) {
          explanation.removeChild(explanation.firstElementChild);
        }
        explanation.innerHTML += char;
        let div = document.createElement("div");
        div.className = "ai-cursor";
        explanation.appendChild(div);
        i++;
        if (delay === 150) {
          document.querySelector(".ai-explanation .ai-cursor").style.opacity = "0";
        }
        if (i === ai_str_length - 1) {
          observer.disconnect(); // 暂停监听
          explanation.removeChild(explanation.firstElementChild);
        }
        sto[0] = setTimeout(() => {
          requestAnimationFrame(animate);
        }, delay);
      }
    } else {
      requestAnimationFrame(animate);
    }
  };
  const observer = new IntersectionObserver(
    entries => {
      let isVisible = entries[0].isIntersecting;
      animationRunning = isVisible; // 标志变量更新
      if (animationRunning) {
        delay_init = i === 0 ? 200 : 20;
        sto[1] = setTimeout(() => {
          if (j) {
            i = 0;
            j = 0;
          }
          if (i === 0) {
            explanation.innerHTML = ai_str.charAt(0);
          }
          requestAnimationFrame(animate);
        }, delay_init);
      }
    },
    { threshold: 0 }
  );
  function clearSTO() {
    if (sto.length) {
      sto.forEach(item => {
        if (item) {
          clearTimeout(item);
        }
      });
    }
  }
  function startAI(str, df = true) {
    i = 0; //重置计数器
    j = 1;
    clearSTO();
    animationRunning = false;
    elapsed = 0;
    observer.disconnect(); // 暂停上一次监听
    explanation.innerHTML = df ? "生成中. . ." : "请等待. . .";
    ai_str = str;
    ai_str_length = ai_str.length;
    observer.observe(post_ai); //启动新监听
  }

  async function aiAbstract(num = 1000) {
    i = 0; //重置计数器
    j = 1;
    clearSTO();
    animationRunning = false;
    elapsed = 0;
    observer.disconnect(); // 暂停上一次监听
    if (mode === "tianli") {
      num = Math.max(10, Math.min(2000, num));
      const options = {
        key: "xxxx",
        Referer: "https://xx.xx/"
      };
      const truncateDescription = ("Github Action实现Android自动打包并发布apk" + "Github Action介绍, 一、Github Action 是什么？, 二、持续集成是什么？, 三、Yaml 是什么？, 四、Github Action 的使用限制, 五、什么是 Workflow？, 5.1 如何定义 Workflow 的名字？, 5.2 如何定义 Workflow 的触发器？, 六、Workflow 的 job 是什么？, 6.1 如何定义一个 job？, 6.2 如何定义 job 的名称？, 6.3 如何定义 job 的依赖？job 是否可以依赖于别的 job 的输出结果？, 6.4 如何定义 job 的运行环境？, 6.5 如何给 job 定义环境变量？, 6.6 如何使用 job 的条件控制语句？, 七、Step 属性是什么？, 7.1 step 运行的是什么？, 八、Action 是什么？, 8.1 我们应该如何使用 Action？, 8.2 上面我们为什么要用：@v2 和 @v2-beta 呢？, 8.3 上面的 with 参数是什么意思？, 九、我们如何运行命令行命令？, 9.1 如何运行多行命令？, 9.2 如何指定 command 运行的位置？, 9.3 如何指定 shell 的类型？（使用 cmd or powershell or python？？）, 十、什么是矩阵？, 如何用GitHub Action自动编译并且发布软件到 Release, 一、配置连接私有秘钥仓库的token, 二、配置 GitHub Action介绍一是什么是推出的持续集成工具二持续集成是什么简单说就是自动化的打包程序如果是前端程序员这样解释比较顺畅每次提交代码到的仓库后都会自动创建一个虚拟机任我们选来执行一段或多段指令由我们定例如三是什么我们集成的做法就是在我们仓库的根目录下创建一个文件夹里面放一个文件这个文件就是我们配置所用的文件四的使用限制每个中的最多可以执行个小时每个最多可以执行小时每个中的最多可以排队小时在一个存储库的所有中一个小时最多可以执行个请求并发工作数专业版可以最多提高到五什么是是由一个或多个组成的可配置的自动化过程我们通过创建文件来创建配置如何定义的名字的名称在存储库的页面上显示的名称如果我们省略则会将其设置为相对于存储库根目录的工作流文件路径如何定义的触发器触发执行的名称比如每当我提交代码到上的时候或者是每当我打的时候单个事件多个事件六的是什么答一个由一个或多个构成含义是一次持续集成的运行可以完成多个任务如何定义一个答通过的定义每个必须具有一个与之关联上面的和就是如何定义的名称会显示在上如何定义的依赖是否可以依赖于别的的输出结果答可以标识是否依赖于别的如果失败则会跳过所有需要该的用于和打配合输出输入的输出用于和打配合可以看到如何定义的运行环境指定运行的运行环境上可用的运行器为如何给定义环境变量如何使用的条件控制语句我们可以使用条件语句来组织运行七属性是什么答每个由多个构成它会从上至下依次执行运行的是什么可以运行命令行命令环境配置命令比如安装个环境安装个环境一段是什么我们后面再说每个都在自己的运行器环境中运行并且可以访问工作空间和文件系统因为每个都在运行器环境中独立运行所以之间不会保留对环境变量的更改定义的名字定义的触发器定义的定义的定义的定义的运行环境定义的运行步骤定义的名称定义的环境变量运行指令输出环境变量八是什么我们可以直接打开下面的市场来看看其实就是命令比如官方给了我们一些默认的命令比如最常用的代码到工作区我们应该如何使用库比如我们可以仓库中最新的代码到的工作区当然我们还可以给它添加个名字库再比如说我们如果是项目我们可以安装与上面我们为什么要用和呢答首先正如大家所想这个和的意思都是的版本我们如果不带版本号的话其实就是默认使用最新版本的了但是官方强烈要求我们带上版本号这样子的话我们就不会出现写好一个但是由于某个的作者一更新我们的就崩了的问题上面的参数是什么意思答有的可能会需要我们传入一些特定的值比如上面的版本啊之类的这些需要我们传入的参数由关键字来引入具体的需要传入哪些参数还请去中的页面中查看具体库的使用和参数我们可以去官方的市场查看市场九我们如何运行命令行命令上文说到可以运行和我们现在已经知道可以使用来运行了那么我们该如何运行呢答案是命令在默认状态下会启动一个没有登录的来作为命令输入器如何运行多行命令每个命令都会启动一个新的所以我们执行多行连续命令的时候需要写在同一个下单行命令多行命令如何指定运行的位置使用关键字我们可以指定的运行位置如何指定的类型使用使用关键字来指定特定的下面是各个系统支持的类型十什么是矩阵答就是有时候我们的代码可能编译环境有多个比如的程序我们需要在上编译压缩包在上编译可执行文件这种时候我们使用矩阵就可以啦比如下面的代码我们使用了矩阵指定了个操作系统个版本这时候下面这段代码就会执行次如何用自动编译并且发布软件到一配置连接私有秘钥仓库的首先点击然后选择依次选择生成新的后复制并保存下来在仓库的设置中依次选择新建一个名为的密钥并将第三步复制的粘贴进去二配置依次点击配置配置如下手动执行一次依次点击如下图所示后表明已经帮我们完成了编译发布这两个操作").trim().substring(0, num)

      const queryParams = `key=${options.key}&content=${truncateDescription}`;
      const requestOptions = {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
          Referer: options.Referer
        },
      };
      try {
        let animationInterval = null
        if (animationInterval) clearInterval(animationInterval);
        animationInterval = setInterval(() => {
          const animationText = "生成中" + ".".repeat(j);
          explanation.innerHTML = animationText;
          j = (j % 3) + 1; // 在 1、2、3 之间循环
        }, 500);
        const response = await fetch(`https://summary.tianli0.top/?${queryParams}`, requestOptions);
        let result;
        if (response.status === 403) {
          result = {
            summary: "403 refer与key不匹配，本地无法显示。"
          }
        } else if (response.status === 500) {
          result = {
            summary: "500 系统内部错误"
          }
        } else {
          result = await response.json();
        }
        const summary = result.summary.trim();
        setTimeout(() => {
          aiTitleRefreshIcon.style.opacity = "1";
        }, 300)
        startAI(summary);
        clearInterval(animationInterval)
      } catch (error) {
        console.error(error);
        explanation.innerHTML = "发生异常" + error;
      }
    } else {
      const strArr = "这篇文章主要介绍了GitHub Action的基本概念和使用方法，以下是文章的摘要：文章首先介绍了GitHub Action是什么，它是GitHub推出的一款持续集成工具，用于自动化构建、测试和部署代码。接着，解释了持续集成的概念，即自动化地执行特定的指令来构建程序，例如在前端项目中自动安装依赖并打包。Yaml文件在GitHub Action中的作用被提及，它是用于配置GitHub Action的文件，通常存放在存储库的根目录下的.github文件夹中。接下来，文章介绍了GitHub Action的一些使用限制，包括job执行时间、API请求限制等。关于Workflow，文章解释了它是由一个或多个job组成的自动化过程，通过创建Yaml文件来配置Workflow。在具体配置Workflow时，文章介绍了如何定义Workflow的名称和触发事件，以及如何定义job、job的名称、依赖关系、运行环境、环境变量等。对于job中的步骤（Step），文章解释了Step的属性，每个job由多个Step构成，每个Step可以运行命令、进行环境配置或执行Action。最后，文章提到了GitHub Action的Action，即可重用的命令集合，通过uses关键字引入，可以用于各种任务，比如代码检查、构建等。文章还介绍了如何使用Action库，如何传递参数以及如何运行命令行命令。总之，该文章详细介绍了GitHub Action的基本概念、配置方法和使用示例，适合初学者了解和入门GitHub Action的使用。".split(",").map(item => item.trim()); // 将字符串转换为数组，去除每个字符串前后的空格
      if (strArr.length !== 1) {
        let randomIndex = Math.floor(Math.random() * strArr.length); // 随机生成一个索引
        while (randomIndex === lastAiRandomIndex) { // 如果随机到了上次的索引
          randomIndex = Math.floor(Math.random() * strArr.length); // 再次随机
        }
        lastAiRandomIndex = randomIndex; // 更新上次随机到的索引
        startAI(strArr[randomIndex]);
      } else {
        startAI(strArr[0])
      }
      setTimeout(() => {
        aiTitleRefreshIcon.style.opacity = "1";
      }, 600)
    }
  }

  function aiRecommend() {
    i = 0; //重置计数器
    j = 1;
    clearSTO();
    animationRunning = false;
    elapsed = 0;
    explanation.innerHTML = "生成中. . .";
    ai_str = "";
    ai_str_length = "";
    observer.disconnect(); // 暂停上一次监听
    sto[2] = setTimeout(() => {
      explanation.innerHTML = recommendList();
    }, 600);
  }
  function aiGoHome() {
    startAI("正在前往博客主页...", false);
    sto[2] = setTimeout(() => {
      pjax.loadUrl("/");
    }, 1000);
  }
  const ai_btn_item = document.querySelectorAll(".ai-btn-item");
  function Introduce() {
    if (mode == "tianli") {
      startAI("我是文章辅助AI: TianliGPT，点击下方的按钮，让我生成本文简介、推荐相关文章等。")
    } else {
      startAI("我是文章辅助AI: Rookie GPT，点击下方的按钮，让我生成本文简介、推荐相关文章等。")
    }
  }
  function aiTitleRefreshIconClick() {
    aiTitleRefreshIcon.click()
  }
  const aiFunctions = [Introduce, aiTitleRefreshIconClick, aiRecommend, aiGoHome];
  ai_btn_item.forEach((item, index) => {
    item.addEventListener("click", () => {
      aiFunctions[index]();
    });
  });

  function recommendList() {
    let thumbnail = document.querySelectorAll('.relatedPosts-list a');
    if (!thumbnail.length) {
      const cardRecentPost = document.querySelector('.card-widget.card-recent-post'); 
      if (!cardRecentPost) return '';

      thumbnail = cardRecentPost.querySelectorAll('.aside-list-item a');

      let list = '';
      for (let i = 0; i < thumbnail.length; i++) {
        const item = thumbnail[i];
        list += `<div class="ai-recommend-item"><span class="index">${i + 1}：</span><a href="javascript:;" onclick="pjax.loadUrl('${item.href}')" title="${item.title}" data-pjax-state="">${item.title}</a></div>`;
      }
      
      return `很抱歉，无法找到类似的文章，你也可以看看本站最新发布的文章：<br /><div class="ai-recommend">${list}</div>`;
    }

    let list = '';
    for (let i = 0; i < thumbnail.length; i++) {
      const item = thumbnail[i];
      list += `<div class="ai-recommend-item"><span>推荐${i + 1}：</span><a href="javascript:;" onclick="pjax.loadUrl('${item.href}')" title="${item.title}" data-pjax-state="">${item.title}</a></div>`;
    }

    return `推荐文章：<br /><div class="ai-recommend">${list}</div>`;
  }


  function changeShowMode() {
    if (mode === "tianli") {
      mode = "local";
      document.getElementById("ai-tag").innerHTML = "Rookie GPT";
      aiAbstract(1000);
    } else {
      mode = "tianli";
      document.getElementById("ai-tag").innerHTML = "Tianli GPT";

      const truncateDescription = ("" + "Github Action介绍, 一、Github Action 是什么？, 二、持续集成是什么？, 三、Yaml 是什么？, 四、Github Action 的使用限制, 五、什么是 Workflow？, 5.1 如何定义 Workflow 的名字？, 5.2 如何定义 Workflow 的触发器？, 六、Workflow 的 job 是什么？, 6.1 如何定义一个 job？, 6.2 如何定义 job 的名称？, 6.3 如何定义 job 的依赖？job 是否可以依赖于别的 job 的输出结果？, 6.4 如何定义 job 的运行环境？, 6.5 如何给 job 定义环境变量？, 6.6 如何使用 job 的条件控制语句？, 七、Step 属性是什么？, 7.1 step 运行的是什么？, 八、Action 是什么？, 8.1 我们应该如何使用 Action？, 8.2 上面我们为什么要用：@v2 和 @v2-beta 呢？, 8.3 上面的 with 参数是什么意思？, 九、我们如何运行命令行命令？, 9.1 如何运行多行命令？, 9.2 如何指定 command 运行的位置？, 9.3 如何指定 shell 的类型？（使用 cmd or powershell or python？？）, 十、什么是矩阵？, 如何用GitHub Action自动编译并且发布软件到 Release, 一、配置连接私有秘钥仓库的token, 二、配置 GitHub Action介绍一是什么是推出的持续集成工具二持续集成是什么简单说就是自动化的打包程序如果是前端程序员这样解释比较顺畅每次提交代码到的仓库后都会自动创建一个虚拟机任我们选来执行一段或多段指令由我们定例如三是什么我们集成的做法就是在我们仓库的根目录下创建一个文件夹里面放一个文件这个文件就是我们配置所用的文件四的使用限制每个中的最多可以执行个小时每个最多可以执行小时每个中的最多可以排队小时在一个存储库的所有中一个小时最多可以执行个请求并发工作数专业版可以最多提高到五什么是是由一个或多个组成的可配置的自动化过程我们通过创建文件来创建配置如何定义的名字的名称在存储库的页面上显示的名称如果我们省略则会将其设置为相对于存储库根目录的工作流文件路径如何定义的触发器触发执行的名称比如每当我提交代码到上的时候或者是每当我打的时候单个事件多个事件六的是什么答一个由一个或多个构成含义是一次持续集成的运行可以完成多个任务如何定义一个答通过的定义每个必须具有一个与之关联上面的和就是如何定义的名称会显示在上如何定义的依赖是否可以依赖于别的的输出结果答可以标识是否依赖于别的如果失败则会跳过所有需要该的用于和打配合输出输入的输出用于和打配合可以看到如何定义的运行环境指定运行的运行环境上可用的运行器为如何给定义环境变量如何使用的条件控制语句我们可以使用条件语句来组织运行七属性是什么答每个由多个构成它会从上至下依次执行运行的是什么可以运行命令行命令环境配置命令比如安装个环境安装个环境一段是什么我们后面再说每个都在自己的运行器环境中运行并且可以访问工作空间和文件系统因为每个都在运行器环境中独立运行所以之间不会保留对环境变量的更改定义的名字定义的触发器定义的定义的定义的定义的运行环境定义的运行步骤定义的名称定义的环境变量运行指令输出环境变量八是什么我们可以直接打开下面的市场来看看其实就是命令比如官方给了我们一些默认的命令比如最常用的代码到工作区我们应该如何使用库比如我们可以仓库中最新的代码到的工作区当然我们还可以给它添加个名字库再比如说我们如果是项目我们可以安装与上面我们为什么要用和呢答首先正如大家所想这个和的意思都是的版本我们如果不带版本号的话其实就是默认使用最新版本的了但是官方强烈要求我们带上版本号这样子的话我们就不会出现写好一个但是由于某个的作者一更新我们的就崩了的问题上面的参数是什么意思答有的可能会需要我们传入一些特定的值比如上面的版本啊之类的这些需要我们传入的参数由关键字来引入具体的需要传入哪些参数还请去中的页面中查看具体库的使用和参数我们可以去官方的市场查看市场九我们如何运行命令行命令上文说到可以运行和我们现在已经知道可以使用来运行了那么我们该如何运行呢答案是命令在默认状态下会启动一个没有登录的来作为命令输入器如何运行多行命令每个命令都会启动一个新的所以我们执行多行连续命令的时候需要写在同一个下单行命令多行命令如何指定运行的位置使用关键字我们可以指定的运行位置如何指定的类型使用使用关键字来指定特定的下面是各个系统支持的类型十什么是矩阵答就是有时候我们的代码可能编译环境有多个比如的程序我们需要在上编译压缩包在上编译可执行文件这种时候我们使用矩阵就可以啦比如下面的代码我们使用了矩阵指定了个操作系统个版本这时候下面这段代码就会执行次如何用自动编译并且发布软件到一配置连接私有秘钥仓库的首先点击然后选择依次选择生成新的后复制并保存下来在仓库的设置中依次选择新建一个名为的密钥并将第三步复制的粘贴进去二配置依次点击配置配置如下手动执行一次依次点击如下图所示后表明已经帮我们完成了编译发布这两个操作").trim().substring(0, 1000);
      let value = Math.floor(Math.random() * 3) + 1000;
      while (value === prevParam || truncateDescription.length - value === prevParam) {
        value = Math.floor(Math.random() * 3) + 1000;
      }
      aiTitleRefreshIcon.style.opacity = "0.2";
      aiTitleRefreshIcon.style.transitionDuration = "0.3s";
      aiTitleRefreshIcon.style.transform = "rotate(" + 360 * refreshNum + "deg)";
      if (truncateDescription.length <= 1000) {
        let param = truncateDescription.length - Math.floor(Math.random() * 3);
        while (param === prevParam) {
          param = truncateDescription.length - Math.floor(Math.random() * 3);
        }
        aiAbstract(param);
        prevParam = param;
      } else {
        aiAbstract(value);
        prevParam = value;
      }
      refreshNum++;
    }
  }

  //- 监听tag点击事件
  document.getElementById("ai-tag").addEventListener("click", () => {
    if (mode === "tianli") {
      document.querySelectorAll(".ai-btn-item").forEach(item => item.style.display = "none");
      document.getElementById("go-tianli-blog").style.display = "block";
      startAI("你好，我是Tianli开发的摘要生成助理TianliGPT，是一个基于GPT-4的生成式AI。我在这里只负责摘要的预生成和显示，你无法与我直接沟通，如果你也需要一个这样的AI摘要接口，可以在下方购买。（暂未开放购买，敬请期待）")
    } else {
      document.getElementById("go-tianli-blog").style.display = "none";
      startAI("你好，我是本站摘要生成助理Rookie GPT，是一个基于GPT-4的生成式AI。我在这里只负责摘要的预生成和显示，你无法与我直接沟通。")
    }

  });

  aiTitleRefreshIcon.addEventListener("click", () => {
    const truncateDescription = ("" + "Github Action介绍, 一、Github Action 是什么？, 二、持续集成是什么？, 三、Yaml 是什么？, 四、Github Action 的使用限制, 五、什么是 Workflow？, 5.1 如何定义 Workflow 的名字？, 5.2 如何定义 Workflow 的触发器？, 六、Workflow 的 job 是什么？, 6.1 如何定义一个 job？, 6.2 如何定义 job 的名称？, 6.3 如何定义 job 的依赖？job 是否可以依赖于别的 job 的输出结果？, 6.4 如何定义 job 的运行环境？, 6.5 如何给 job 定义环境变量？, 6.6 如何使用 job 的条件控制语句？, 七、Step 属性是什么？, 7.1 step 运行的是什么？, 八、Action 是什么？, 8.1 我们应该如何使用 Action？, 8.2 上面我们为什么要用：@v2 和 @v2-beta 呢？, 8.3 上面的 with 参数是什么意思？, 九、我们如何运行命令行命令？, 9.1 如何运行多行命令？, 9.2 如何指定 command 运行的位置？, 9.3 如何指定 shell 的类型？（使用 cmd or powershell or python？？）, 十、什么是矩阵？, 如何用GitHub Action自动编译并且发布软件到 Release, 一、配置连接私有秘钥仓库的token, 二、配置 GitHub Action介绍一是什么是推出的持续集成工具二持续集成是什么简单说就是自动化的打包程序如果是前端程序员这样解释比较顺畅每次提交代码到的仓库后都会自动创建一个虚拟机任我们选来执行一段或多段指令由我们定例如三是什么我们集成的做法就是在我们仓库的根目录下创建一个文件夹里面放一个文件这个文件就是我们配置所用的文件四的使用限制每个中的最多可以执行个小时每个最多可以执行小时每个中的最多可以排队小时在一个存储库的所有中一个小时最多可以执行个请求并发工作数专业版可以最多提高到五什么是是由一个或多个组成的可配置的自动化过程我们通过创建文件来创建配置如何定义的名字的名称在存储库的页面上显示的名称如果我们省略则会将其设置为相对于存储库根目录的工作流文件路径如何定义的触发器触发执行的名称比如每当我提交代码到上的时候或者是每当我打的时候单个事件多个事件六的是什么答一个由一个或多个构成含义是一次持续集成的运行可以完成多个任务如何定义一个答通过的定义每个必须具有一个与之关联上面的和就是如何定义的名称会显示在上如何定义的依赖是否可以依赖于别的的输出结果答可以标识是否依赖于别的如果失败则会跳过所有需要该的用于和打配合输出输入的输出用于和打配合可以看到如何定义的运行环境指定运行的运行环境上可用的运行器为如何给定义环境变量如何使用的条件控制语句我们可以使用条件语句来组织运行七属性是什么答每个由多个构成它会从上至下依次执行运行的是什么可以运行命令行命令环境配置命令比如安装个环境安装个环境一段是什么我们后面再说每个都在自己的运行器环境中运行并且可以访问工作空间和文件系统因为每个都在运行器环境中独立运行所以之间不会保留对环境变量的更改定义的名字定义的触发器定义的定义的定义的定义的运行环境定义的运行步骤定义的名称定义的环境变量运行指令输出环境变量八是什么我们可以直接打开下面的市场来看看其实就是命令比如官方给了我们一些默认的命令比如最常用的代码到工作区我们应该如何使用库比如我们可以仓库中最新的代码到的工作区当然我们还可以给它添加个名字库再比如说我们如果是项目我们可以安装与上面我们为什么要用和呢答首先正如大家所想这个和的意思都是的版本我们如果不带版本号的话其实就是默认使用最新版本的了但是官方强烈要求我们带上版本号这样子的话我们就不会出现写好一个但是由于某个的作者一更新我们的就崩了的问题上面的参数是什么意思答有的可能会需要我们传入一些特定的值比如上面的版本啊之类的这些需要我们传入的参数由关键字来引入具体的需要传入哪些参数还请去中的页面中查看具体库的使用和参数我们可以去官方的市场查看市场九我们如何运行命令行命令上文说到可以运行和我们现在已经知道可以使用来运行了那么我们该如何运行呢答案是命令在默认状态下会启动一个没有登录的来作为命令输入器如何运行多行命令每个命令都会启动一个新的所以我们执行多行连续命令的时候需要写在同一个下单行命令多行命令如何指定运行的位置使用关键字我们可以指定的运行位置如何指定的类型使用使用关键字来指定特定的下面是各个系统支持的类型十什么是矩阵答就是有时候我们的代码可能编译环境有多个比如的程序我们需要在上编译压缩包在上编译可执行文件这种时候我们使用矩阵就可以啦比如下面的代码我们使用了矩阵指定了个操作系统个版本这时候下面这段代码就会执行次如何用自动编译并且发布软件到一配置连接私有秘钥仓库的首先点击然后选择依次选择生成新的后复制并保存下来在仓库的设置中依次选择新建一个名为的密钥并将第三步复制的粘贴进去二配置依次点击配置配置如下手动执行一次依次点击如下图所示后表明已经帮我们完成了编译发布这两个操作").trim().substring(0, 1000);
    let value = Math.floor(Math.random() * 3) + 1000;
    while (value === prevParam || truncateDescription.length - value === prevParam) {
      value = Math.floor(Math.random() * 3) + 1000;
    }
    aiTitleRefreshIcon.style.opacity = "0.2";
    aiTitleRefreshIcon.style.transitionDuration = "0.3s";
    aiTitleRefreshIcon.style.transform = "rotate(" + 360 * refreshNum + "deg)";
    if (truncateDescription.length <= 1000) {
      let param = truncateDescription.length - Math.floor(Math.random() * 3);
      while (param === prevParam) {
        param = truncateDescription.length - Math.floor(Math.random() * 3);
      }
      aiAbstract(param);
      prevParam = param;
    } else {
      aiAbstract(value);
      prevParam = value;
    }
    showAiBtn();
    refreshNum++;
  });

  document.getElementById("go-tianli-blog").addEventListener("click", () => {
    window.open("https://afdian.net/item/886a79d4db6711eda42a52540025c377", "_blank");
  });
  
  if (false) {
    document.getElementById("ai-Toggle").addEventListener("click", () => {
      changeShowMode()
    });
  }

  function showAiBtn() {
    document.querySelectorAll(".ai-btn-item").forEach(item => {
      if (item.id !== "go-tianli-blog") {
        item.style.display = "block";
      }
      if (item.id === "go-tianli-blog") {
        item.style.display = "none";
      }
    });
  }


  aiAbstract();
  showAiBtn()
})()</script></div><article class="post-content" id="article-container"><h2 id="Github-Action介绍"><a href="#Github-Action介绍" class="headerlink" title="Github Action介绍"></a>Github Action介绍</h2><h3 id="一、Github-Action-是什么？"><a href="#一、Github-Action-是什么？" class="headerlink" title="一、Github Action 是什么？"></a>一、Github Action 是什么？</h3><p>是 Github 推出的持续集成工具</p>
<h3 id="二、持续集成是什么？"><a href="#二、持续集成是什么？" class="headerlink" title="二、持续集成是什么？"></a>二、持续集成是什么？</h3><p>简单说就是自动化的打包程序——如果是前端程序员，这样解释比较顺畅：</p>
<p>每次提交代码到 Github 的仓库后，Github 都会自动创建一个虚拟机（Mac &#x2F; Windows &#x2F; Linux 任我们选），来执行一段或多段指令（由我们定），例如：</p>
<ol>
<li>npm install</li>
<li>npm run build</li>
</ol>
<h3 id="三、Yaml-是什么？"><a href="#三、Yaml-是什么？" class="headerlink" title="三、Yaml 是什么？"></a>三、Yaml 是什么？</h3><p>我们集成 Github Action 的做法，就是在我们仓库的根目录下，创建一个 .github 文件夹，里面放一个 *.yaml 文件——这个 Yaml 文件就是我们配置 Github Action 所用的文件。</p>
<h3 id="四、Github-Action-的使用限制"><a href="#四、Github-Action-的使用限制" class="headerlink" title="四、Github Action 的使用限制"></a>四、Github Action 的使用限制</h3><ul>
<li>每个 Workflow 中的 job 最多可以执行 6 个小时</li>
<li>每个 Workflow 最多可以执行 72 小时</li>
<li>每个 Workflow 中的 job 最多可以排队 24 小时</li>
<li>在一个存储库的所有 Action 中，一个小时最多可以执行 1000 个 API 请求</li>
<li>并发工作数：Linux：20，Mac：5（专业版可以最多提高到 180 &#x2F; 50）</li>
</ul>
<h3 id="五、什么是-Workflow？"><a href="#五、什么是-Workflow？" class="headerlink" title="五、什么是 Workflow？"></a>五、什么是 Workflow？</h3><p>Workflow 是由一个或多个 job 组成的可配置的自动化过程。我们通过创建 YAML 文件来创建 Workflow 配置。</p>
<hr>
<h4 id="5-1-如何定义-Workflow-的名字？"><a href="#5-1-如何定义-Workflow-的名字？" class="headerlink" title="5.1 如何定义 Workflow 的名字？"></a>5.1 如何定义 Workflow 的名字？</h4><blockquote>
<p>name</p>
</blockquote>
<p>Workflow 的名称，Github 在存储库的 Action 页面上显示 Workflow 的名称。</p>
<p>如果我们省略 name，则 Github 会将其设置为相对于存储库根目录的工作流文件路径。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name: Greeting from Mona</span><br><span class="line">on: push</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="5-2-如何定义-Workflow-的触发器？"><a href="#5-2-如何定义-Workflow-的触发器？" class="headerlink" title="5.2 如何定义 Workflow 的触发器？"></a>5.2 如何定义 Workflow 的触发器？</h4><blockquote>
<p>on</p>
</blockquote>
<p>触发 Workflow 执行的 event 名称，比如：<strong>每当我提交代码到 Github 上的时候，或者是每当我打 TAG 的时候。</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 单个事件</span><br><span class="line">on: push</span><br><span class="line"></span><br><span class="line">// 多个事件</span><br><span class="line">on: [push,pull_request]</span><br></pre></td></tr></table></figure>

<h3 id="六、Workflow-的-job-是什么？"><a href="#六、Workflow-的-job-是什么？" class="headerlink" title="六、Workflow 的 job 是什么？"></a>六、Workflow 的 job 是什么？</h3><p>答：一个 Workflow 由一个或多个 jobs 构成，含义是一次持续集成的运行，可以完成多个任务。</p>
<h4 id="6-1-如何定义一个-job？"><a href="#6-1-如何定义一个-job？" class="headerlink" title="6.1 如何定义一个 job？"></a>6.1 如何定义一个 job？</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jobs:</span><br><span class="line">  my_first_job:</span><br><span class="line">    name: My first job</span><br><span class="line">  my_second_job:</span><br><span class="line">    name: My second job</span><br></pre></td></tr></table></figure>

<p>答：通过 job 的 id 定义。</p>
<p>每个 job 必须具有一个 id 与之关联。</p>
<p>上面的 my_first_job 和 my_second_job 就是 job_id。</p>
<h4 id="6-2-如何定义-job-的名称？"><a href="#6-2-如何定义-job-的名称？" class="headerlink" title="6.2 如何定义 job 的名称？"></a>6.2 如何定义 job 的名称？</h4><blockquote>
<p>jobs.<job_id>.name</p>
</blockquote>
<p>name 会显示在 Github 上</p>
<h4 id="6-3-如何定义-job-的依赖？job-是否可以依赖于别的-job-的输出结果？"><a href="#6-3-如何定义-job-的依赖？job-是否可以依赖于别的-job-的输出结果？" class="headerlink" title="6.3 如何定义 job 的依赖？job 是否可以依赖于别的 job 的输出结果？"></a>6.3 如何定义 job 的依赖？job 是否可以依赖于别的 job 的输出结果？</h4><blockquote>
<p>jobs.<job_id>.needs</p>
</blockquote>
<p>答：needs 可以标识 job 是否依赖于别的 job——如果 job 失败，则会跳过所有需要该 job 的 job。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">jobs:</span><br><span class="line">  job1:</span><br><span class="line">  job2:</span><br><span class="line">    needs: job1</span><br><span class="line">  job3:</span><br><span class="line">    needs: [job1, job2]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>jobs.<jobs_id>.outputs：用于和 need 打配合，outputs 输出&#x3D;》need 输入</p>
</blockquote>
<p>jobs 的输出，用于和 needs 打配合：可以看到 ouput</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">jobs:</span><br><span class="line">  job1:</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    # Map a step output to a job output</span><br><span class="line">    outputs:</span><br><span class="line">      output1: $&#123;&#123; steps.step1.outputs.test &#125;&#125;</span><br><span class="line">      output2: $&#123;&#123; steps.step2.outputs.test &#125;&#125;</span><br><span class="line">    steps:</span><br><span class="line">    - id: step1</span><br><span class="line">      run: echo &quot;::set-output name=test::hello&quot;</span><br><span class="line">    - id: step2</span><br><span class="line">      run: echo &quot;::set-output name=test::world&quot;</span><br><span class="line">  job2:</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    needs: job1</span><br><span class="line">    steps:</span><br><span class="line">    - run: echo $&#123;&#123;needs.job1.outputs.output1&#125;&#125; $&#123;&#123;needs.job1.outputs.output2&#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-4-如何定义-job-的运行环境？"><a href="#6-4-如何定义-job-的运行环境？" class="headerlink" title="6.4 如何定义 job 的运行环境？"></a>6.4 如何定义 job 的运行环境？</h4><blockquote>
<p>jobs.<job_id>.runs-on</p>
</blockquote>
<p>指定运行 job 的运行环境，Github 上可用的运行器为：</p>
<ul>
<li>windows-2019</li>
<li>ubuntu-20.04</li>
<li>ubuntu-18.04</li>
<li>ubuntu-16.04</li>
<li>macos-10.15</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jobs:</span><br><span class="line">  job1:</span><br><span class="line">    runs-on: macos-10.15</span><br><span class="line">  job2:</span><br><span class="line">    runs-on: windows-2019</span><br></pre></td></tr></table></figure>

<h4 id="6-5-如何给-job-定义环境变量？"><a href="#6-5-如何给-job-定义环境变量？" class="headerlink" title="6.5 如何给 job 定义环境变量？"></a>6.5 如何给 job 定义环境变量？</h4><blockquote>
<p>jobs.<jobs_id>.env</p>
</blockquote>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jobs:</span><br><span class="line">  job1:</span><br><span class="line">    env:</span><br><span class="line">      FIRST_NAME: Mona</span><br></pre></td></tr></table></figure>

<h4 id="6-6-如何使用-job-的条件控制语句？"><a href="#6-6-如何使用-job-的条件控制语句？" class="headerlink" title="6.6 如何使用 job 的条件控制语句？"></a>6.6 如何使用 job 的条件控制语句？</h4><blockquote>
<p>jobs.<job_id>.if</p>
</blockquote>
<p>我们可以使用 if 条件语句来组织 job 运行</p>
<hr>
<h3 id="七、Step-属性是什么？"><a href="#七、Step-属性是什么？" class="headerlink" title="七、Step 属性是什么？"></a>七、Step 属性是什么？</h3><p>答：每个 job 由多个 step 构成，它会从上至下依次执行。</p>
<h4 id="7-1-step-运行的是什么？"><a href="#7-1-step-运行的是什么？" class="headerlink" title="7.1 step 运行的是什么？"></a>7.1 step 运行的是什么？</h4><p><strong>step 可以运行：</strong></p>
<ol>
<li><strong>command</strong>s：命令行命令</li>
<li><strong>setup tasks</strong>：环境配置命令（比如安装个 Node 环境、安装个 Python 环境）</li>
<li><strong>action</strong>（in your repository, in public repository, in Docker registry）：一段 action（Action 是什么我们后面再说）</li>
</ol>
<p><strong>每个 step 都在自己的运行器环境中运行，并且可以访问工作空间和文件系统。</strong></p>
<p>因为每个 step 都在运行器环境中独立运行，所以 <strong>step 之间不会保留对环境变量的更改</strong>。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># 定义 Workflow 的名字</span><br><span class="line">name: Greeting from Mona</span><br><span class="line"></span><br><span class="line"># 定义 Workflow 的触发器</span><br><span class="line">on: push</span><br><span class="line"></span><br><span class="line"># 定义 Workflow 的 job</span><br><span class="line">jobs:</span><br><span class="line">  # 定义 job 的 id</span><br><span class="line">  my-job:</span><br><span class="line">    # 定义 job 的 name</span><br><span class="line">    name: My Job</span><br><span class="line">    # 定义 job 的运行环境</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    # 定义 job 的运行步骤</span><br><span class="line">    steps:</span><br><span class="line">    # 定义 step 的名称</span><br><span class="line">    - name: Print a greeting</span><br><span class="line">      # 定义 step 的环境变量</span><br><span class="line">      env:</span><br><span class="line">        MY_VAR: Hi there! My name is</span><br><span class="line">        FIRST_NAME: Mona</span><br><span class="line">        MIDDLE_NAME: The</span><br><span class="line">        LAST_NAME: Octocat</span><br><span class="line">      # 运行指令：输出环境变量</span><br><span class="line">      run: |</span><br><span class="line">        echo $MY_VAR $FIRST_NAME $MIDDLE_NAME $LAST_NAME.</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="八、Action-是什么？"><a href="#八、Action-是什么？" class="headerlink" title="八、Action 是什么？"></a>八、Action 是什么？</h3><p>我们可以直接打开下面的 Action 市场来看看：</p>
<p><a href="https://link.zhihu.com/?target=https://github.com/marketplace?type=actions">https://github.com/marketplace?type=actionsgithub.com/marketplace?type=actions</a></p>
<p>Action 其实就是命令，比如 Github 官方给了我们一些默认的命令：</p>
<p><a href="https://link.zhihu.com/?target=https://github.com/marketplace?type=actions&query=actions">GitHub Marketplace: actions to improve your workflowgithub.com&#x2F;marketplace?type&#x3D;actions&amp;query&#x3D;actions<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic4.zhimg.com/v2-d06dfc50fef28a5c76fa9034fe797faf_180x120.jpg" alt="img"></a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.zhimg.com/80/v2-5208c22215435edfa36040d6b217c325_720w.webp" alt="img"></p>
<p>比如最常用的，check-out 代码到 Workflow 工作区：</p>
<p><a href="https://link.zhihu.com/?target=https://github.com/marketplace/actions/checkout">https://github.com/marketplace/actions/checkoutgithub.com/marketplace/actions/checkout</a></p>
<h4 id="8-1-我们应该如何使用-Action？"><a href="#8-1-我们应该如何使用-Action？" class="headerlink" title="8.1 我们应该如何使用 Action？"></a>8.1 我们应该如何使用 Action？</h4><blockquote>
<p>jobs.<job_id>.steps.uses</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic3.zhimg.com/80/v2-e6855fd2e091401590baf4febf356cce_720w.webp" alt="img"></p>
<p>Action 库：Checkout</p>
<p>比如我们可以 check-out 仓库中最新的代码到 Workflow 的工作区：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steps:</span><br><span class="line">  - uses: actions/checkout@v2</span><br></pre></td></tr></table></figure>

<p>当然，我们还可以给它添加个名字：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">steps:</span><br><span class="line">  - name: Check out Git repository</span><br><span class="line">    uses: actions/checkout@v2</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.zhimg.com/80/v2-8ea878b5f2917be32ba9aa18b3a1cef9_720w.webp" alt="img"></p>
<p>Action 库：Setup Node</p>
<p>再比如说，我们如果是 node 项目，我们可以安装 Node.js 与 NPM：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">steps:</span><br><span class="line">- uses: actions/checkout@v2</span><br><span class="line">- uses: actions/setup-node@v2-beta</span><br><span class="line">  with:</span><br><span class="line">    node-version: &#x27;12&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-上面我们为什么要用：-v2-和-v2-beta-呢？"><a href="#8-2-上面我们为什么要用：-v2-和-v2-beta-呢？" class="headerlink" title="8.2 上面我们为什么要用：@v2 和 @v2-beta 呢？"></a>8.2 上面我们为什么要用：@v2 和 @v2-beta 呢？</h4><p>答：首先，正如大家所想，这个 @v2 和 @v2-beta 的意思都是 Action 的版本。</p>
<p>我们如果不带版本号的话，其实就是默认使用最新版本的了。</p>
<p>但是 <strong>Github 官方强烈要求我们带上版本号</strong>——这样子的话，我们就不会出现：<strong>写好一个 Workflow，但是由于某个 Action 的作者一更新，我们的 Workflow 就崩了的问题。</strong></p>
<h4 id="8-3-上面的-with-参数是什么意思？"><a href="#8-3-上面的-with-参数是什么意思？" class="headerlink" title="8.3 上面的 with 参数是什么意思？"></a><strong>8.3 上面的 with 参数是什么意思？</strong></h4><p>答：<strong>有的 Action 可能会需要我们传入一些特定的值</strong>：比如上面的 node 版本啊之类的，这些<strong>需要我们传入的参数由 with 关键字来引入</strong>。</p>
<p><strong>具体的 Action 需要传入哪些参数，还请去 Github Action Market 中 Action 的页面中查看。</strong></p>
<p>具体库的使用和参数，我们可以去官方的 Action 市场查看：</p>
<p><a href="https://link.zhihu.com/?target=https://github.com/marketplace/actions/">Github Action 市场github.com&#x2F;marketplace&#x2F;actions&#x2F;</a></p>
<hr>
<h3 id="九、我们如何运行命令行命令？"><a href="#九、我们如何运行命令行命令？" class="headerlink" title="九、我们如何运行命令行命令？"></a>九、我们如何运行命令行命令？</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jobs.&lt;job_id&gt;.steps.run</span><br></pre></td></tr></table></figure>

<p>上文说到，<strong>steps 可以运行：action 和 command-line programs</strong>。</p>
<p>我们现在已经知道<strong>可以使用 uses 来运行 action 了</strong>，那么我们该如何运行 command-line programs 呢？</p>
<p><strong>答案是：run</strong></p>
<p><strong>run 命令在默认状态下会启动一个没有登录的 shell 来作为命令输入器。</strong></p>
<h4 id="9-1-如何运行多行命令？"><a href="#9-1-如何运行多行命令？" class="headerlink" title="9.1 如何运行多行命令？"></a><strong>9.1 如何运行多行命令？</strong></h4><p><strong>每个 run 命令都会启动一个新的 shell，所以我们执行多行连续命令的时候需要写在同一个 run 下：</strong></p>
<ul>
<li><strong>单行命令</strong></li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- name: Install Dependencies</span><br><span class="line">  run: npm install</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>多行命令</strong></li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- name: Clean install dependencies and build</span><br><span class="line">  run： |</span><br><span class="line">    npm ci</span><br><span class="line">    npm run build</span><br></pre></td></tr></table></figure>



<h4 id="9-2-如何指定-command-运行的位置？"><a href="#9-2-如何指定-command-运行的位置？" class="headerlink" title="9.2 如何指定 command 运行的位置？"></a>9.2 如何指定 command 运行的位置？</h4><p>使用 working-directory 关键字，我们可以指定 command 的运行位置：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- name: Clean temp directory</span><br><span class="line">  run: rm -rf *</span><br><span class="line">  working-directory: ./temp</span><br></pre></td></tr></table></figure>



<h4 id="9-3-如何指定-shell-的类型？（使用-cmd-or-powershell-or-python？？）"><a href="#9-3-如何指定-shell-的类型？（使用-cmd-or-powershell-or-python？？）" class="headerlink" title="9.3 如何指定 shell 的类型？（使用 cmd or powershell or python？？）"></a>9.3 如何指定 shell 的类型？（使用 cmd or powershell or python？？）</h4><p>使用 shell 关键字，来指定特定的 shell：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">steps:</span><br><span class="line">  - name: Display the path</span><br><span class="line">    run: echo $PATH</span><br><span class="line">    shell: bash</span><br></pre></td></tr></table></figure>

<p>下面是各个系统支持的 shell 类型：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.zhimg.com/80/v2-9283bfe170157cf550cbc86c36fa28c5_720w.webp" alt="img"></p>
<hr>
<h3 id="十、什么是矩阵？"><a href="#十、什么是矩阵？" class="headerlink" title="十、什么是矩阵？"></a>十、什么是矩阵？</h3><p>答：就是有时候，我们的代码可能编译环境有多个。比如 electron 的程序，我们需要在 macos 上编译 dmg 压缩包，在 windows 上编译 exe 可执行文件。</p>
<p><strong>这种时候，我们使用矩阵就可以啦~</strong></p>
<p>比如下面的代码，我们使用了矩阵指定了：<strong>2 个操作系统，3 个 node 版本</strong>。</p>
<p>这时候<strong>下面这段代码就会执行 6 次</strong>—— 2 x 3 &#x3D; 6！！！</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">runs-on: $&#123;&#123; matrix.os &#125;&#125;</span><br><span class="line">strategy:</span><br><span class="line">  matrix:</span><br><span class="line">    os: [ubuntu-16.04, ubuntu-18.04]</span><br><span class="line">    node: [6, 8, 10]</span><br><span class="line">steps:</span><br><span class="line">  - uses: actions/setup-node@v1</span><br><span class="line">    with:</span><br><span class="line">      node-version: $&#123;&#123; matrix.node &#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="如何用GitHub-Action自动编译并且发布软件到-Release"><a href="#如何用GitHub-Action自动编译并且发布软件到-Release" class="headerlink" title="如何用GitHub Action自动编译并且发布软件到 Release"></a>如何用GitHub Action自动编译并且发布软件到 Release</h2><h3 id="一、配置连接私有秘钥仓库的token"><a href="#一、配置连接私有秘钥仓库的token" class="headerlink" title="一、配置连接私有秘钥仓库的token"></a>一、配置连接私有秘钥仓库的token</h3><ol>
<li>首先点击 <code>Settings</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p1.meituan.net/csc/fe431f6c5e071351005b8f960891b1a539243.png" alt="image.png"></p>
<ol start="2">
<li>然后选择<code>Developer settings</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p0.meituan.net/csc/43fff60e59380a738053cdd60ed0e1f7279525.png" alt="image.png"></p>
<ol start="3">
<li>依次选择<code>Tokens</code> -&gt; <code>generate new token</code>生成新的token后复制并保存下来。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p1.meituan.net/csc/af9948599cade116963039b4f6897988176494.png" alt="image.png"></p>
<ol start="4">
<li>在仓库的设置中依次选择 <code>Settings</code> -&gt; <code>Secrets and variables</code> -&gt; <code>Action</code> -&gt; <code>new repository secret</code>新建一个名为TOKEN的密钥，并将第三步复制的token粘贴进去。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p0.meituan.net/csc/f381faeac8abed51ad36adee738ef4d7336383.png" alt="image.png"></p>
<h3 id="二、配置-GitHub-Action"><a href="#二、配置-GitHub-Action" class="headerlink" title="二、配置 GitHub Action"></a>二、配置 GitHub Action</h3><ol>
<li>依次点击 <code>Action</code> -&gt; <code>Android CI</code> -&gt; <code>Configure</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p0.meituan.net/csc/f2d6e561835f7aa369fde4574259892f374070.png" alt="image.png"></p>
<ol start="2">
<li>配置 <code>android.yml</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p0.meituan.net/csc/c210d15c2d5069928b0cd2072e8366d3274932.png" alt="image.png"></p>
<ul>
<li><code>android.yml</code>配置如下</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Build</span> <span class="string">and</span> <span class="string">Release</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line"> <span class="attr">push:</span></span><br><span class="line">   <span class="attr">branches:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;feature/*&quot;</span></span><br><span class="line">   <span class="attr">tags:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;v*.*.*&quot;</span></span><br><span class="line"> <span class="attr">pull_request:</span></span><br><span class="line">   <span class="attr">branches:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;feature/*&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line"> <span class="attr">apk:</span></span><br><span class="line">   <span class="attr">name:</span> <span class="string">Generate</span> <span class="string">APK</span></span><br><span class="line">   <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">   <span class="attr">steps:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/checkout@v2.4.0</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Branch</span> <span class="string">name</span></span><br><span class="line">       <span class="attr">run:</span> <span class="string">echo</span> <span class="string">running</span> <span class="string">on</span> <span class="string">branch</span> <span class="string">$&#123;GITHUB_REF##*/&#125;</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">JDK</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/setup-java@v2.5.0</span></span><br><span class="line">       <span class="attr">with:</span></span><br><span class="line">         <span class="attr">distribution:</span> <span class="string">temurin</span></span><br><span class="line">         <span class="attr">java-version:</span> <span class="string">&quot;11&quot;</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">execution</span> <span class="string">flag</span> <span class="string">for</span> <span class="string">gradlew</span></span><br><span class="line">       <span class="attr">run:</span> <span class="string">chmod</span> <span class="string">+x</span> <span class="string">gradlew</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">APK</span></span><br><span class="line">       <span class="attr">run:</span> <span class="string">bash</span> <span class="string">./gradlew</span> <span class="string">assembleDebug</span> <span class="string">--stacktrace</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">APK</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/upload-artifact@v1</span></span><br><span class="line">       <span class="attr">with:</span></span><br><span class="line">         <span class="attr">name:</span> <span class="string">apk</span></span><br><span class="line">         <span class="attr">path:</span> <span class="string">app/build/outputs/apk/debug/app-debug.apk</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">release:</span></span><br><span class="line">   <span class="attr">name:</span> <span class="string">Release</span> <span class="string">APK</span></span><br><span class="line">   <span class="attr">needs:</span> <span class="string">apk</span></span><br><span class="line">   <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">   <span class="attr">steps:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Get</span> <span class="string">branch</span> <span class="string">name</span></span><br><span class="line">       <span class="attr">id:</span> <span class="string">branch-name</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">tj-actions/branch-names@v5.1</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Print</span> <span class="string">branch</span>    </span><br><span class="line">       <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">         echo &quot;Running on default: $&#123;&#123; steps.branch-name.outputs.current_branch &#125;&#125;&quot;</span></span><br><span class="line"><span class="string"></span>       </span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Download</span> <span class="string">APK</span> <span class="string">from</span> <span class="string">build</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/download-artifact@v1</span></span><br><span class="line">       <span class="attr">with:</span></span><br><span class="line">         <span class="attr">name:</span> <span class="string">apk</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">Release</span></span><br><span class="line">       <span class="attr">id:</span> <span class="string">create_release</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/create-release@v1</span></span><br><span class="line">       <span class="attr">env:</span></span><br><span class="line">         <span class="attr">GITHUB_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">       <span class="attr">with:</span></span><br><span class="line">         <span class="attr">tag_name:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.run_number</span> <span class="string">&#125;&#125;</span></span><br><span class="line">         <span class="attr">release_name:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.repository.name</span> <span class="string">&#125;&#125;</span>  <span class="string">$&#123;&#123;</span> <span class="string">steps.branch-name.outputs.current_branch</span> <span class="string">&#125;&#125;</span> <span class="string">v$&#123;&#123;</span> <span class="string">github.run_number</span> <span class="string">&#125;&#125;.$&#123;&#123;</span> <span class="string">github.run_attempt</span> <span class="string">&#125;&#125;</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">Release</span> <span class="string">APK</span></span><br><span class="line">       <span class="attr">id:</span> <span class="string">upload_release_asset</span></span><br><span class="line">       <span class="attr">uses:</span> <span class="string">actions/upload-release-asset@v1.0.1</span></span><br><span class="line">       <span class="attr">env:</span></span><br><span class="line">         <span class="attr">GITHUB_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">       <span class="attr">with:</span></span><br><span class="line">         <span class="attr">upload_url:</span> <span class="string">$&#123;&#123;</span> <span class="string">steps.create_release.outputs.upload_url</span> <span class="string">&#125;&#125;</span></span><br><span class="line">         <span class="attr">asset_path:</span> <span class="string">apk/app-debug.apk</span></span><br><span class="line">         <span class="attr">asset_name:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.repository.name</span> <span class="string">&#125;&#125;</span>  <span class="string">$&#123;&#123;</span> <span class="string">steps.branch-name.outputs.current_branch</span> <span class="string">&#125;&#125;</span> <span class="string">v$&#123;&#123;</span> <span class="string">github.run_number</span> <span class="string">&#125;&#125;.$&#123;&#123;</span> <span class="string">github.run_attempt</span> <span class="string">&#125;&#125;.apk</span></span><br><span class="line">         <span class="attr">asset_content_type:</span> <span class="string">application/zip</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>手动执行一次<code>Action</code> 依次点击 <code>Action</code> -&gt; <code>Build and Release</code> -&gt; <code>Update android.yml</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p0.meituan.net/csc/e1dbb65ea6a7f7de21d6c9d0730d19d3205339.png" alt="image.png"></p>
<ol start="4">
<li>如下图所示后，表明Action 已经帮我们完成了编译-发布这两个操作。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://p1.meituan.net/csc/3fe33a7c8b4f494fbab499b98545674f324900.png" alt="image.png"></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Rookie_l</div><div class="post-copyright__author_desc">偷得浮生半日闲</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://icu007work.github.io/archives/40fd71e7.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://icu007work.github.io/archives/40fd71e7.html')">Github Action实现Android自动打包并发布apk</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://icu007work.github.io/archives/40fd71e7.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Github Action实现Android自动打包并发布apk&amp;url=https://icu007work.github.io/archives/40fd71e7.html&amp;pic=https://pic.ziyuan.wang/2023/08/23/bab4140e88a71.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://icu007work.github.io" target="_blank">米奇妙妙屋</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"></div></div></div><div class="post_share"><div class="social-share" data-image="https://pic2.ziyuan.wang/user/xiheya/2024/05/安卓开发入门_2838f20538180.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/archives/5e339248.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.ziyuan.wang/2023/08/23/c4bfc940f3cac.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Typora快捷键</div></div></a></div><div class="next-post pull-right"><a href="/archives/5d597b5d.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.ziyuan.wang/2023/08/23/42cbb98bf5698.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Hexo发布文章指北</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-top" title="点击展开"><div class="card-info-avatar"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-status-box"><div class="author-status"><g-emoji class="g-emoji" alias="writing_hand" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/270d.png">😊</g-emoji><span>on Studying</span></div></div></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">本站有关于<b style="color:#fff">科技、生活</b>相关的文章和随笔，还有<b style="color:#fff">编程基础知识</b>和<b style="color:#fff">实用工具</b>分享。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">希望你可以在本站中收获对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Rookie_l</h1><div class="author-info__desc">偷得浮生半日闲</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/hiheya" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/55406380" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://pic.ziyuan.wang/2023/08/22/30087e712d9fd.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://pic.ziyuan.wang/2023/08/22/e91ab86cccd2c.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Github-Action%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">Github Action介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81Github-Action-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">一、Github Action 是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">二、持续集成是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81Yaml-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.3.</span> <span class="toc-text">三、Yaml 是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81Github-Action-%E7%9A%84%E4%BD%BF%E7%94%A8%E9%99%90%E5%88%B6"><span class="toc-number">1.4.</span> <span class="toc-text">四、Github Action 的使用限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF-Workflow%EF%BC%9F"><span class="toc-number">1.5.</span> <span class="toc-text">五、什么是 Workflow？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89-Workflow-%E7%9A%84%E5%90%8D%E5%AD%97%EF%BC%9F"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 如何定义 Workflow 的名字？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89-Workflow-%E7%9A%84%E8%A7%A6%E5%8F%91%E5%99%A8%EF%BC%9F"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 如何定义 Workflow 的触发器？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD%E3%80%81Workflow-%E7%9A%84-job-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.6.</span> <span class="toc-text">六、Workflow 的 job 是什么？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA-job%EF%BC%9F"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 如何定义一个 job？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89-job-%E7%9A%84%E5%90%8D%E7%A7%B0%EF%BC%9F"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 如何定义 job 的名称？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89-job-%E7%9A%84%E4%BE%9D%E8%B5%96%EF%BC%9Fjob-%E6%98%AF%E5%90%A6%E5%8F%AF%E4%BB%A5%E4%BE%9D%E8%B5%96%E4%BA%8E%E5%88%AB%E7%9A%84-job-%E7%9A%84%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C%EF%BC%9F"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 如何定义 job 的依赖？job 是否可以依赖于别的 job 的输出结果？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89-job-%E7%9A%84%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83%EF%BC%9F"><span class="toc-number">1.6.4.</span> <span class="toc-text">6.4 如何定义 job 的运行环境？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-%E5%A6%82%E4%BD%95%E7%BB%99-job-%E5%AE%9A%E4%B9%89%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%EF%BC%9F"><span class="toc-number">1.6.5.</span> <span class="toc-text">6.5 如何给 job 定义环境变量？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-job-%E7%9A%84%E6%9D%A1%E4%BB%B6%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5%EF%BC%9F"><span class="toc-number">1.6.6.</span> <span class="toc-text">6.6 如何使用 job 的条件控制语句？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%83%E3%80%81Step-%E5%B1%9E%E6%80%A7%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.7.</span> <span class="toc-text">七、Step 属性是什么？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-step-%E8%BF%90%E8%A1%8C%E7%9A%84%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 step 运行的是什么？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AB%E3%80%81Action-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.8.</span> <span class="toc-text">八、Action 是什么？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-%E6%88%91%E4%BB%AC%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-Action%EF%BC%9F"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 我们应该如何使用 Action？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-%E4%B8%8A%E9%9D%A2%E6%88%91%E4%BB%AC%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%EF%BC%9A-v2-%E5%92%8C-v2-beta-%E5%91%A2%EF%BC%9F"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2 上面我们为什么要用：@v2 和 @v2-beta 呢？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-3-%E4%B8%8A%E9%9D%A2%E7%9A%84-with-%E5%8F%82%E6%95%B0%E6%98%AF%E4%BB%80%E4%B9%88%E6%84%8F%E6%80%9D%EF%BC%9F"><span class="toc-number">1.8.3.</span> <span class="toc-text">8.3 上面的 with 参数是什么意思？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E6%88%91%E4%BB%AC%E5%A6%82%E4%BD%95%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%9F"><span class="toc-number">1.9.</span> <span class="toc-text">九、我们如何运行命令行命令？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-%E5%A6%82%E4%BD%95%E8%BF%90%E8%A1%8C%E5%A4%9A%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%9F"><span class="toc-number">1.9.1.</span> <span class="toc-text">9.1 如何运行多行命令？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-%E5%A6%82%E4%BD%95%E6%8C%87%E5%AE%9A-command-%E8%BF%90%E8%A1%8C%E7%9A%84%E4%BD%8D%E7%BD%AE%EF%BC%9F"><span class="toc-number">1.9.2.</span> <span class="toc-text">9.2 如何指定 command 运行的位置？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-3-%E5%A6%82%E4%BD%95%E6%8C%87%E5%AE%9A-shell-%E7%9A%84%E7%B1%BB%E5%9E%8B%EF%BC%9F%EF%BC%88%E4%BD%BF%E7%94%A8-cmd-or-powershell-or-python%EF%BC%9F%EF%BC%9F%EF%BC%89"><span class="toc-number">1.9.3.</span> <span class="toc-text">9.3 如何指定 shell 的类型？（使用 cmd or powershell or python？？）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E7%9F%A9%E9%98%B5%EF%BC%9F"><span class="toc-number">1.10.</span> <span class="toc-text">十、什么是矩阵？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E7%94%A8GitHub-Action%E8%87%AA%E5%8A%A8%E7%BC%96%E8%AF%91%E5%B9%B6%E4%B8%94%E5%8F%91%E5%B8%83%E8%BD%AF%E4%BB%B6%E5%88%B0-Release"><span class="toc-number">2.</span> <span class="toc-text">如何用GitHub Action自动编译并且发布软件到 Release</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E9%85%8D%E7%BD%AE%E8%BF%9E%E6%8E%A5%E7%A7%81%E6%9C%89%E7%A7%98%E9%92%A5%E4%BB%93%E5%BA%93%E7%9A%84token"><span class="toc-number">2.1.</span> <span class="toc-text">一、配置连接私有秘钥仓库的token</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E9%85%8D%E7%BD%AE-GitHub-Action"><span class="toc-number">2.2.</span> <span class="toc-text">二、配置 GitHub Action</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/archives/3ba91e1b.html" title="Kotlin安卓开发入门"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.ziyuan.wang/user/xiheya/2024/05/安卓开发入门_2838f20538180.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kotlin安卓开发入门"/></a><div class="content"><a class="title" href="/archives/3ba91e1b.html" title="Kotlin安卓开发入门">Kotlin安卓开发入门</a><time datetime="2024-10-11T03:37:21.000Z" title="发表于 2024-10-11 11:37:21">2024-10-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/add4ecd9.html" title="Kotlin入门"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.ziyuan.wang/2023/09/11/guest_566671d879c50.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kotlin入门"/></a><div class="content"><a class="title" href="/archives/add4ecd9.html" title="Kotlin入门">Kotlin入门</a><time datetime="2023-09-11T07:56:35.000Z" title="发表于 2023-09-11 15:56:35">2023-09-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/9765c01a.html" title="语雀同款链接卡片—butterfly主题标签外挂"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.ziyuan.wang/2023/08/22/8e5180b414a23.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="语雀同款链接卡片—butterfly主题标签外挂"/></a><div class="content"><a class="title" href="/archives/9765c01a.html" title="语雀同款链接卡片—butterfly主题标签外挂">语雀同款链接卡片—butterfly主题标签外挂</a><time datetime="2023-08-03T07:02:03.000Z" title="发表于 2023-08-03 15:02:03">2023-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/419d96b2.html" title="IDEA使用技巧"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.ziyuan.wang/2023/08/23/31c4c2e2cd96d.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="IDEA使用技巧"/></a><div class="content"><a class="title" href="/archives/419d96b2.html" title="IDEA使用技巧">IDEA使用技巧</a><time datetime="2023-07-29T07:30:11.000Z" title="发表于 2023-07-29 15:30:11">2023-07-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/9491d997.html" title="Sublime Text 4(4143)注册方法"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.ziyuan.wang/2023/08/23/0534ecc832ab3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Sublime Text 4(4143)注册方法"/></a><div class="content"><a class="title" href="/archives/9491d997.html" title="Sublime Text 4(4143)注册方法">Sublime Text 4(4143)注册方法</a><time datetime="2023-07-26T03:54:24.000Z" title="发表于 2023-07-26 11:54:24">2023-07-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:rookie_l@icu007.work" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com/u/5400016811" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=61550101473898&amp;mibextid=2JQ9oc" title="facebook"><i class="anzhiyufont anzhiyu-icon-facebook1"></i></a><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/hiheya" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/55406380" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://v.douyin.com/iJm1hSu7/" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a><a class="deal_link" href="/copyright" title="CC"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="51la统计" target="_blank" rel="noopener" href="https://v6.51.la/">51la统计</a><a class="footer-item" title="十年之约" target="_blank" rel="noopener" href="https://www.foreverblog.cn/">十年之约</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">关于</div><div class="footer-links"><a class="footer-item" title="关于作者" href="/about/">关于作者</a><a class="footer-item" title="文章归档" href="/archives/">文章归档</a><a class="footer-item" title="更新日志" href="/update/">更新日志</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a><a class="footer-item" title="友链文章" href="/fcircle/">友链文章</a><a class="footer-item" title="留言板" href="/comments/">留言板</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies" href="/cookies/">Cookies</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="Rookie_l" target="_blank">Rookie_l</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = ["尊重所有声音&#44; 但成为自己."]
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#footer-type-tips', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: false,
          backSpeed: 50,
        })
      } else {
        document.getElementById('footer-type-tips').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.0.15/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://icu007.work" title="主站">主站</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div></div></div><div id="sidebar"><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://icu007.work/wp-content/uploads/2022/03/head-1.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">50</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 站务</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 空调</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=6842714056&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 番剧</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 碎碎念</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 传送门</span></a></li></ul></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch_commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="6842714056" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/#/playlist?id=6842714056&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.14/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.3.1/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'DSKC4Zc0A0aO83qSYyJIczkF-gzGzoHsz',
      appKey: 'X4vG5DxFgvkzTBQNF8IRA7gi',
      avatar: 'monsterid',
      serverURLs: '',
      placeholder: '文明因交流而多彩，因互鉴而丰富。(填写QQ邮箱就会使用QQ头像喔~.)',
      master: 'xxxxx,1a05412655c3814b90e4a3f0f269f6a4',
      friends: 'xxxxxx',
      tagMeta: ["博主","小伙伴","访客"],
      enableQQ: 'true',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, {"valine":"/js/myjs/Valine.min.js"}))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('/js/myjs/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script src="https://cdn.cbd.int/blueimp-md5@2.19.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=monsterid'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://DSKC4Zc0.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": 'DSKC4Zc0A0aO83qSYyJIczkF-gzGzoHsz',
        "X-LC-Key": 'X4vG5DxFgvkzTBQNF8IRA7gi',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "visitor@anheyu.com";</script><script>//动态标题
let leaveTitle = 'w(ﾟДﾟ)w 你你你去哪啦??!';
let backTitle = '♪(^∇^*)你回来啦！';
let OriginTitile = document.title
let titleTime
document.addEventListener('visibilitychange', function () {
  if (document.hidden) {
    //离开当前页面时标签显示内容
    document.title = leaveTitle
    clearTimeout(titleTime)
  } else {
    //返回当前页面时标签显示内容
    document.title = backTitle + OriginTitile
    //两秒后变回正常标题
    titleTime = setTimeout(function () {
      document.title = OriginTitile
    }, 2000)
  }
})</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script>// 初始化函数
let rm = {};

//禁止图片与超链接拖拽
let aElements = document.getElementsByTagName("a");
for (let i = 0; i < aElements.length; i++) {
  aElements[i].setAttribute("draggable", "false");
  let imgElements = aElements[i].getElementsByTagName("img");
  for (let j = 0; j < imgElements.length; j++) {
    imgElements[j].setAttribute("draggable", "false");
  }
}

// 显示菜单
rm.showRightMenu = function (isTrue, x = 0, y = 0) {
  console.info(x, y)
  let rightMenu = document.getElementById("rightMenu");
  rightMenu.style.top = x + "px";
  rightMenu.style.left = y + "px";
  if (isTrue) {
    rightMenu.style.display = "block";
    stopMaskScroll();
  } else {
    rightMenu.style.display = "none";
  }
};

// 隐藏菜单
rm.hideRightMenu = function () {
  rm.showRightMenu(false);
  let rightMenuMask = document.querySelector("#rightmenu-mask");
  rightMenuMask.style.display = "none";
};

// 尺寸
let rmWidth = document.getElementById("rightMenu").offsetWidth;
let rmHeight = document.getElementById("rightMenu").offsetHeight;

// 重新定义尺寸
rm.reloadrmSize = function () {
  rightMenu.style.visibility = "hidden";
  rightMenu.style.display = "block";
  // 获取宽度和高度
  rmWidth = document.getElementById("rightMenu").offsetWidth;
  rmHeight = document.getElementById("rightMenu").offsetHeight;
  rightMenu.style.visibility = "visible";
};

// 获取点击的href
let domhref = "";
let domImgSrc = "";
let globalEvent = null;

var oncontextmenuFunction = function (event) {
  if (document.body.clientWidth > 768) {
    let pageX = event.clientX + 10; //加10是为了防止显示时鼠标遮在菜单上
    let pageY = event.clientY;

    //其他额外菜单
    const $rightMenuOther = document.querySelector(".rightMenuOther");
    const $rightMenuPlugin = document.querySelector(".rightMenuPlugin");
    const $rightMenuCopyText = document.querySelector("#menu-copytext");
    const $rightMenuPasteText = document.querySelector("#menu-pastetext");
    const $rightMenuCommentText = document.querySelector("#menu-commenttext");
    const $rightMenuNewWindow = document.querySelector("#menu-newwindow");
    const $rightMenuNewWindowImg = document.querySelector("#menu-newwindowimg");
    const $rightMenuCopyLink = document.querySelector("#menu-copylink");
    const $rightMenuCopyImg = document.querySelector("#menu-copyimg");
    const $rightMenuDownloadImg = document.querySelector("#menu-downloadimg");
    const $rightMenuSearch = document.querySelector("#menu-search");
    const $rightMenuSearchBaidu = document.querySelector("#menu-searchBaidu");
    const $rightMenuMusicToggle = document.querySelector("#menu-music-toggle");
    const $rightMenuMusicBack = document.querySelector("#menu-music-back");
    const $rightMenuMusicForward = document.querySelector("#menu-music-forward");
    const $rightMenuMusicPlaylist = document.querySelector("#menu-music-playlist");
    const $rightMenuMusicCopyMusicName = document.querySelector("#menu-music-copyMusicName");

    let href = event.target.href;
    let imgsrc = event.target.currentSrc;

    // 判断模式 扩展模式为有事件
    let pluginMode = false;
    $rightMenuOther.style.display = "block";
    globalEvent = event;

    // 检查是否需要复制 是否有选中文本
    if (selectTextNow && window.getSelection()) {
      pluginMode = true;
      $rightMenuCopyText.style.display = "block";
      $rightMenuCommentText.style.display = "block";
      $rightMenuSearch.style.display = "block";
      $rightMenuSearchBaidu.style.display = "block";
    } else {
      $rightMenuCopyText.style.display = "none";
      $rightMenuCommentText.style.display = "none";
      $rightMenuSearchBaidu.style.display = "none";
      $rightMenuSearch.style.display = "none";
    }

    //检查是否右键点击了链接a标签
    if (href) {
      pluginMode = true;
      $rightMenuNewWindow.style.display = "block";
      $rightMenuCopyLink.style.display = "block";
      domhref = href;
    } else {
      $rightMenuNewWindow.style.display = "none";
      $rightMenuCopyLink.style.display = "none";
    }

    //检查是否需要复制图片
    if (imgsrc) {
      pluginMode = true;
      $rightMenuCopyImg.style.display = "block";
      $rightMenuDownloadImg.style.display = "block";
      $rightMenuNewWindowImg.style.display = "block";
      document.getElementById("rightMenu").style.width="12rem"
      domImgSrc = imgsrc;
    } else {
      $rightMenuCopyImg.style.display = "none";
      $rightMenuDownloadImg.style.display = "none";
      $rightMenuNewWindowImg.style.display = "none";
    }

    // 判断是否为输入框
    if (event.target.tagName.toLowerCase() === "input" || event.target.tagName.toLowerCase() === "textarea") {
      pluginMode = true;
      $rightMenuPasteText.style.display = "block";
    } else {
      $rightMenuPasteText.style.display = "none";
    }
    const navMusicEl = document.querySelector("#nav-music");
    //判断是否是音乐
    if (navMusicEl && navMusicEl.contains(event.target)) {
      pluginMode = true;
      $rightMenuMusicToggle.style.display = "block";
      $rightMenuMusicBack.style.display = "block";
      $rightMenuMusicForward.style.display = "block";
      $rightMenuMusicPlaylist.style.display = "block";
      $rightMenuMusicCopyMusicName.style.display = "block";
    } else {
      $rightMenuMusicToggle.style.display = "none";
      $rightMenuMusicBack.style.display = "none";
      $rightMenuMusicForward.style.display = "none";
      $rightMenuMusicPlaylist.style.display = "none";
      $rightMenuMusicCopyMusicName.style.display = "none";
    }

    // 如果不是扩展模式则隐藏扩展模块
    if (pluginMode) {
      $rightMenuOther.style.display = "none";
      $rightMenuPlugin.style.display = "block";
    } else {
      $rightMenuPlugin.style.display = "none";
    }

    rm.reloadrmSize();

    // 鼠标默认显示在鼠标右下方，当鼠标靠右或靠下时，将菜单显示在鼠标左方\上方
    if (pageX + rmWidth > window.innerWidth) {
      pageX -= rmWidth + 10;
    }
    if (pageY + rmHeight > window.innerHeight) {
      pageY -= pageY + rmHeight - window.innerHeight;
    }

    rm.showRightMenu(true, pageY, pageX);
    document.getElementById("rightmenu-mask").style.display = "flex";
    return false;
  }
};

// 监听右键初始化
window.oncontextmenu = oncontextmenuFunction

// 下载图片状态
rm.downloadimging = false;

// 复制图片到剪贴板
rm.writeClipImg = function (imgsrc) {
  console.log("按下复制");
  rm.hideRightMenu();
  anzhiyu.snackbarShow("正在下载中，请稍后", false, 10000);
  if (rm.downloadimging == false) {
    rm.downloadimging = true;
    setTimeout(function () {
      copyImage(imgsrc);
      anzhiyu.snackbarShow("复制成功！图片已添加盲水印，请遵守版权协议");
      rm.downloadimging = false;
    }, "10000");
  }
};

function imageToBlob(imageURL) {
  const img = new Image();
  const c = document.createElement("canvas");
  const ctx = c.getContext("2d");
  img.crossOrigin = "";
  img.src = imageURL;
  return new Promise(resolve => {
    img.onload = function () {
      c.width = this.naturalWidth;
      c.height = this.naturalHeight;
      ctx.drawImage(this, 0, 0);
      c.toBlob(
        blob => {
          // here the image is a blob
          resolve(blob);
        },
        "image/png",
        0.75
      );
    };
  });
}

//- async function copyImage(imageURL) {
//-   const blob = await imageToBlob(imageURL);
//-   const item = new ClipboardItem({ "image/png": blob });
//-   navigator.clipboard.write([item]);
//- }
async function copyImage(e) {
  const n = await imageToBlob(e)
    , t = new ClipboardItem({
      "image/png": n
  });
  navigator.clipboard.write([t])
}

rm.copyUrl = function (id) {
  const input = document.createElement("input"); // Create a new <input> element
  input.id = "copyVal"; // Set the id of the new element to "copyVal"
  document.body.appendChild(input); // Append the new element to the end of the <body> element
  
  const text = id;
  input.value = text;
  input.select();
  input.setSelectionRange(0, input.value.length);
  document.execCommand("copy");
  
  input.remove(); // Remove the <input> element from the DOM
};

function stopMaskScroll() {
  if (document.getElementById("rightmenu-mask")) {
    let xscroll = document.getElementById("rightmenu-mask");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //阻止浏览器默认方法
        rm.hideRightMenu();
        // e.preventDefault();
      },
      { passive: true }
    );
  }
  if (document.getElementById("rightMenu")) {
    let xscroll = document.getElementById("rightMenu");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //阻止浏览器默认方法
        rm.hideRightMenu();
        // e.preventDefault();
      },
      { passive: true }
    );
  }
}

rm.rightmenuCopyText = function (txt) {
  if (navigator.clipboard) {
    navigator.clipboard.writeText(txt);
  }
  rm.hideRightMenu();
};

//- rm.copyPageUrl = function (url) {
//-   if (!url) {
//-     url = window.location.href;
//-   }
//-   rm.copyUrl(url);
//-   anzhiyu.snackbarShow("复制链接地址成功", false, 2000);
//-   rm.hideRightMenu();
//- };
rm.copyPageUrl = function() {
  var e = window.location.href;
  rm.copyUrl(e),
  anzhiyu.snackbarShow("复制链接地址成功", false, 2000);
  rm.hideRightMenu()
}

rm.sharePage = function () {
  var content = window.location.href;
  rm.copyUrl(url);
  anzhiyu.snackbarShow("复制链接地址成功", false, 2000);
  rm.hideRightMenu();
};

// 复制当前选中文本
var selectTextNow = "window.getSelection().toString())";
document.onmouseup = document.ondblclick = selceText;

function selceText() {
  var txt;
  if (document.selection) {
    txt = document.selection.createRange().text;
  } else {
    txt = window.getSelection().toString();
  }
  selectTextNow = txt !== "" ? txt : "";
}

// 读取剪切板
rm.readClipboard = function () {
  if (navigator.clipboard) {
    navigator.clipboard.readText().then(clipText => rm.insertAtCaret(globalEvent.target, clipText));
  }
};

// 粘贴文本到焦点
rm.insertAtCaret = function (elemt, value) {
  const startPos = elemt.selectionStart,
    endPos = elemt.selectionEnd;
  if (document.selection) {
    elemt.focus();
    var sel = document.selection.createRange();
    sel.text = value;
    elemt.focus();
  } else {
    if (startPos || startPos == "0") {
      var scrollTop = elemt.scrollTop;
      elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);
      elemt.focus();
      elemt.selectionStart = startPos + value.length;
      elemt.selectionEnd = startPos + value.length;
      elemt.scrollTop = scrollTop;
    } else {
      elemt.value += value;
      elemt.focus();
    }
  }
};

//粘贴文本
rm.pasteText = function () {
  const result = rm.readClipboard() || "";
  rm.hideRightMenu();
};

//引用到评论
rm.rightMenuCommentText = function (txt) {
  rm.hideRightMenu();
  const postCommentDom = document.getElementById("post-comment");
  var domTop = postCommentDom.offsetTop;
  window.scrollTo(0, domTop - 80);
  if (txt == "undefined" || txt == "null") txt = "好棒！";
  function setText() {
    setTimeout(() => {
      var input = document.getElementsByClassName("el-textarea__inner")[0];
      if (!input) setText();
      let evt = document.createEvent("HTMLEvents");
      evt.initEvent("input", true, true);
      let inputValue = replaceAll(txt, "\n", "\n> ");
      input.value = "> " + inputValue + "\n\n";
      input.dispatchEvent(evt);
      input.focus();
      input.setSelectionRange(-1, -1);
      if (document.getElementById("comment-tips")) {
        document.getElementById("comment-tips").classList.add("show");
      }
    }, 100);
  }
  setText();
};

//替换所有内容
function replaceAll(string, search, replace) {
  return string.split(search).join(replace);
}

// 百度搜索
rm.searchBaidu = function () {
  anzhiyu.snackbarShow("即将跳转到百度搜索", false, 2000);
  setTimeout(function () {
    window.open("https://www.baidu.com/s?wd=" + selectTextNow);
  }, "2000");
  rm.hideRightMenu();
};

//分享链接
rm.copyLink = function () {
  rm.rightmenuCopyText(domhref);
  anzhiyu.snackbarShow("已复制链接地址");
};

function addRightMenuClickEvent() {
  // 添加点击事件
  document.getElementById("menu-backward").addEventListener("click", function () {
  window.history.back();
    rm.hideRightMenu();
  });

  document.getElementById("menu-forward").addEventListener("click", function () {
    window.history.forward();
    rm.hideRightMenu();
  });

  document.getElementById("menu-refresh").addEventListener("click", function () {
    window.location.reload();
  });

  document.getElementById("menu-top").addEventListener("click", function () {
    anzhiyu.scrollToDest(0, 500);
    rm.hideRightMenu();
  });

  const menuLinks = document.querySelectorAll(".menu-link");
  menuLinks.forEach(function (link) {
    link.addEventListener("click", rm.hideRightMenu);
  });

  document.getElementById("menu-darkmode").addEventListener("click", anzhiyu.switchDarkMode);

  document.getElementById("menu-home") && document.getElementById("menu-home").addEventListener("click", function () {
    window.location.href = window.location.origin;
  });

  document.getElementById("menu-randomPost").addEventListener("click", function () {
    toRandomPost();
  });

  document.getElementById("menu-commentBarrage").addEventListener("click", anzhiyu.switchCommentBarrage);

  document.getElementById("rightmenu-mask").addEventListener("click", rm.hideRightMenu);

  document.getElementById("rightmenu-mask").addEventListener("contextmenu", function (event) {
    rm.hideRightMenu();
    event.preventDefault(); // Prevent the default context menu from appearing
  });

  document.getElementById("menu-copy").addEventListener("click", rm.copyPageUrl);

  document.getElementById("menu-pastetext").addEventListener("click", rm.pasteText);

  document.getElementById("menu-copytext").addEventListener("click", function () {
    rm.rightmenuCopyText(selectTextNow);
    anzhiyu.snackbarShow("复制成功，复制和转载请标注本文地址");
  });

  document.getElementById("menu-commenttext").addEventListener("click", function () {
    rm.rightMenuCommentText(selectTextNow);
  });

  document.getElementById("menu-newwindow").addEventListener("click", function () {
    window.open(domhref, "_blank");
    rm.hideRightMenu();
  });

  document.getElementById("menu-copylink").addEventListener("click", rm.copyLink);

  document.getElementById("menu-downloadimg").addEventListener("click", function () {
    anzhiyu.downloadImage(domImgSrc, "Charlie_l_default");
  });

  document.getElementById("menu-newwindowimg").addEventListener("click", function () {
    window.open(domImgSrc, "_blank");
    rm.hideRightMenu();
  });

  document.getElementById("menu-copyimg").addEventListener("click", function () {
    rm.writeClipImg(domImgSrc);
  });

  document.getElementById("menu-searchBaidu").addEventListener("click", rm.searchBaidu);

  //音乐
  document.getElementById("menu-music-toggle").addEventListener("click", anzhiyu.musicToggle);

  document.getElementById("menu-music-back").addEventListener("click", anzhiyu.musicSkipBack);

  document.getElementById("menu-music-forward").addEventListener("click", anzhiyu.musicSkipForward);

  document.getElementById("menu-music-copyMusicName").addEventListener("click", function () {
    rm.rightmenuCopyText(anzhiyu.musicGetName());
    anzhiyu.snackbarShow("复制歌曲名称成功", false, 3000);
  });

}

addRightMenuClickEvent();</script><script data-pjax>var themeColorMeta = document.querySelector('meta[name="theme-color"]');
var pageHeaderEl = document.getElementById("page-header");
var navMusicEl = document.getElementById("nav-music");
var consoleEl = document.getElementById("console");
// 已随机的歌曲
var selectRandomSong = [];
// 音乐默认声音大小
var musicVolume = 0.8;
// 是否切换了周杰伦音乐列表
var changeMusicListFlag = false;
// 当前默认播放列表
var defaultPlayMusicList = [];

document.getElementById("page-name").innerText = document.title.split(" | 米奇妙妙屋")[0];
anzhiyu.initIndexEssay();
anzhiyu.changeTimeInEssay();
anzhiyu.removeBodyPaceClass();
anzhiyu.qrcodeCreate();
anzhiyu.changeTimeInAlbumDetail();
anzhiyu.reflashEssayWaterFall();
anzhiyu.sayhi();
anzhiyu.stopImgRightDrag();
anzhiyu.addNavBackgroundInit();
anzhiyu.setValueToBodyType();
anzhiyu.catalogActive();
anzhiyu.tagsPageActive();
anzhiyu.categoriesBarActive();
anzhiyu.topCategoriesBarScroll();
anzhiyu.switchRightClickMenuHotReview();
anzhiyu.getCustomPlayList();
anzhiyu.addEventListenerConsoleMusicList(false);
setTimeout(() => {if (typeof addFriendLinksInFooter === "function") {addFriendLinksInFooter();}}, 200)</script><script>const loadScript = (url, charset = "UTF-8", crossorigin) => {
  return new Promise((resolve, reject) => {
    const script = document.createElement('script');
    script.src = url;
    script.async = true;
    if (charset) {
      script.setAttribute("charset", charset);
    }
    if (crossorigin) {
      script.setAttribute("crossorigin", crossorigin);
    }
    script.onerror = reject;
    script.onload = script.onreadystatechange = function() {
      const loadState = this.readyState;
      if (loadState && loadState !== 'loaded' && loadState !== 'complete') return;
      script.onload = script.onreadystatechange = null;
      resolve();
    };
    document.head.appendChild(script);
  });
};

const scriptUrls = [
  { url: 'https://sdk.51.la/js-sdk-pro.min.js', charset: 'UTF-8', id: 'LA_COLLECT' },
  { url: 'https://sdk.51.la/perf/js-sdk-perf.min.js', crossorigin: 'anonymous' }
];

Promise.all(scriptUrls.map(({ url, charset, crossorigin }) => loadScript(url, charset, crossorigin)))
  .then(() => {
    LA.init({ id: "3FfSkp1Eunbavgru", ck: "3FfSkp1Eunbavgru" });
    new LingQue.Monitor().init({ id: "3FfSkp1Eunbavgru", sendSuspicious: true });
  })
  .catch(error => {
    console.error('本地无法加载51a统计，线上即可加载:', error);
  });
</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script type="text/javascript" src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div></body></html>